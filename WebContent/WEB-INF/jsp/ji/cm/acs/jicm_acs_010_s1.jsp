<%--/*=================================================================================*//* 시스템            : JRCMS 시스템 SYSTEM/* 프로그램 아이디   : /WEB-INF/jsp/ji/cm/acs/jicm_acs_010_s1.jsp/* 프로그램 이름     : jicm_acs_010_s1  /* 소스파일 이름     : jicm_acs_010_s1.jsp/* 설명              : SYSTEM 접근아이피관리 목록페이지/* 버전              : 1.0.0/* 최초 작성자       : 이금용/* 최초 작성일자     : 2014-02-03/* 최근 수정자       : 이금용/* 최근 수정일시     : 2014-02-03/* 최종 수정내용     : 최초작성/*=================================================================================*/--%><%@page pageEncoding="utf-8"%><script language="javascript" src="<%=con_root%>/js/com-file.js"></script><%@ taglib prefix="comTag" uri="/WEB-INF/tld/comTag.xml"%><script type="text/javascript" src="<%=con_root%>/js/jquery.form.min.js"  charset="utf-8"></script><script src="<%=con_root%>/js/jquery-ui.js" type="text/javascript"></script><style>.paging{text-align: center;margin-top: 40px;}.paging a{display: inline-block;padding: 0 9px;}.paging a.page_on{color: #fff;background: #1e8dde;padding: 2px 7.5px 3px 7.5px;margin-right: 3px;}.paging button{font-size: 0;line-height: 0;width: 11px;height: 18px;display: inline-block;vertical-align: top;}.paging button.first{background: url(/images/common/common_bg.png) -551px -183px no-repeat;}.paging button.prev{background: url(/images/common/common_bg.png) -453px -245px no-repeat;width: 7px;margin-left: 15px;margin-right: 20px;}.paging button.next{background: url(/images/common/common_bg.png) -453px -252px no-repeat;transform: rotate(180deg);width: 7px;margin-left: 20px;}.paging button.last{background: url(/images/common/common_bg.png) -551px -190px no-repeat;transform: rotate(180deg);margin-left: 15px;}</style><form name="regfrm" method="post" onsubmit="return false;">	<input type="hidden" name="scode" value="<c:out value="${scode}"/>" title="사이트코드" />	<input type="hidden" name="pcode" value="<c:out value="${pcode}"/>" title="페이지코드"  />	<input type="hidden" name="pstate" value="<c:out value="${pstate}"/>" title="페이지상태"  />	<input type="hidden" 	id="pageIndex"  name="pageIndex"	value="<c:out value="${R_MAP.param.pageIndex}"/>" title="현재페이지번호"  />     <p class="sectionBlueBg round mT10" style=""><span class="pOrg">*아이피는 4자리를 모두 입력해주세요 EX) 123.123.123.123</span><br />     <span class="span_txt">현재 접속한 피씨의 아이피 : <span class="pBlue"><%=RemoteAddr%></span></span></p>      	<div class="sectionBlue mT10">  		    <table class="defaultTable02">		    <caption>접근아이피 등록</caption>			  <colgroup>				<col width="120" />				<col width="250" />				<col width="120" />				<col width="*" />				<col width="120" />				<col width="40" />				<col width="200" />			  </colgroup>		      		<tr>				      	<th class="aC">아이피</th>				      	<td>				      		<input type="text" name="AC_IP" value="" size="20" title="등록할 아이피" />				      	</td>				      	<th>담당자</th>						<td>							<input type="hidden" name="USE_ID" id="USE_ID" value="">							<input name="keyword" title="담당자" id="keyword" type="text" maxlength="10" value="" style="width: 100px;" />							<span id="keywordTarget" style="padding-left: 5px; display:inline-block;"></span>				      	 </td>				      	<th class="aC">설명</th>				      	<td><input name="AC_BIGO" type="text" value="" size="25" title="아이피설명" /></td>				      	<th class="aC">사용여부</th>				      	<td><input type="checkbox" name="USE_YN" value="Y" title="등록할 아이피 사용여부" checked="checked" /></td>				        <td class="aR"><span class="btn_pack large"><a href="#" Onclick="Go_wrin();">등록</a></span></td>			       </tr>		    </table> 		</div> </form>       <!--목록시작-->		<form action="<c:out value='${basePath}'/>/cmsmain.do" id="listfrm" name="listfrm" method="post" onsubmit="return false;">			<input type="hidden"	id="scode"		name="scode"		value="<c:out value="${scode}"/>" />			<input type="hidden"	id="pcode"		name="pcode"		value="<c:out value="${pcode}"/>" />			<input type="hidden"	id="pstate"		name="pstate"		value="<c:out value="${pstate}"/>" />			<input type="hidden" 	id="pageIndex"  name="pageIndex"	value="<c:out value="${R_MAP.param.pageIndex}"/>" title="현재페이지번호"  />			<input type="hidden" name="sidx" value="">						<div class="cts_mid">				<div class="searchArea">					<div class="formInner" style="text-align:right;">						이름, 사번, IP검색&nbsp;&nbsp;<input type="text" name="searchValue" id="searchValue" value="<c:out value="${R_MAP.param.searchValue}"/>" title="검색어 입력" onkeydown="if(event.keyCode==13){javascript:fn_searchList(1);}"/>						<input type="text" name="submitguard" id="submitguard" style="display: none;" />						<span class="btn_pack large" style="margin-top:2px;"><a href="#" Onclick="javascript:fn_searchList(1);">검색</a></span>					</div>				</div>								<div class="sectionBlue">					<table class="tbl_type">					<caption>접근아이피 리스트</caption>					<colgroup>					<col width="8%" />					<col width="15%" />					<col width="25%" />					<col width="10%" />					<col width="15%" />					<col width="5%" />					<col />					</colgroup>						<thead>							<tr id="list_th_obj">							    <th scope="col" style="text-align:center;">번호</th>							    <th scope="col" style="text-align:center;">아이피주소</th>							    <th scope="col" style="text-align:center;">담당자</th>							    <th scope="col" style="text-align:center;">사용여부</th>							    <th scope="col" style="text-align:center;">작성일</th>							    <th scope="col" style="text-align:center;">설명</th>							    <th scope="col" style="text-align:center;">비고</th>							  </tr>						</thead>						<tbody id="list_data_obj">							<c:choose>							<c:when test="${R_MAP.selectListCnt > 0 }">								<c:forEach items="${R_MAP.selectList}" var="list" varStatus="i">									<tr>										<td><c:out value="${list.rnum}"/></td>										<td><input type="text" name="AC_IP<c:out value="${list.idx}"/>" value="<c:out value="${list.ac_ip}"/>"></td>										<td>											<input type="hidden" name="USE_ID<c:out value="${list.idx}"/>" id="USE_ID<c:out value="${list.idx}"/>" value="">											<!--input name="keyword<c:out value="${list.idx}"/>" title="담당자" id="keyword<c:out value="${list.idx}"/>" type="text" maxlength="10" value="" style="width: 100px;" /-->											<span id="keywordTarget<c:out value="${list.idx}"/>" style="padding-left: 5px; display:inline-block;"></span>										</td>										<td><input type="checkbox" name="USE_YN<c:out value="${list.idx}"/>" value="Y" title="등록할 아이피 사용여부" <c:if test="${list.use_yn eq 'Y'}"> checked='checked'</c:if>></td>										<td><c:out value="${list.reg_dt}"/></td>										<td><input type="text" name="AC_BIGO<c:out value="${list.idx}"/>" value="<c:out value="${list.ac_bigo}"/>"></td>										<td>											<span class="btn_pack large"><a href="#"  Onclick="Go_modin(<c:out value="${list.idx}"/>);" >수정</a></span>											<span class="btn_pack largeG"><a href="#" Onclick="Go_delin(<c:out value="${list.idx}"/>);" >삭제</a></span></td>									</tr>								</c:forEach>							</c:when>							<c:otherwise>								<tr>									<td colspan="7" align="center">조회된 데이터가 없습니다.</td>								</tr>							</c:otherwise>						</c:choose>						</tbody>					</table>				</div>				<div class="paging">				<c:if test="${R_MAP.selectListCnt > 0}">							<comTag:paging totalCount="${fn:escapeXml(R_MAP.selectListCnt)}" pageNo="${fn:escapeXml(R_MAP.param.pageIndex)}" pageSize="${fn:escapeXml(R_MAP.param.pageSize)}" clickPage="fn_searchList"/>				</c:if>			</div>			</div>		</form><!--목록끝--><script type='text/javascript'>//<![CDATA[var resultKeyword = "";var ins_use_id = "";var keywordsList = new Array();$(document).ready(function() {	var keywordIdx;	var resultHtml = "";	var resultHtmlArr = [];	<c:forEach var="list" items="${R_MAP.selectList}" varStatus="status" >		keywordIdx = 0;		var use_id = "<c:out value='${list.use_id }'/>";		if(use_id == null || use_id == "") {		} else {			//resultHtmlArr.push("<span style='width:100px;' id='keywordSpan${list.idx}'><c:out value='${list.user_name }'/>(<c:out value='${list.use_id }'/>)</span><span id='keywordDelBtn${list.idx}' class='keywordDelBtn'><a onclick='javascript:fn_deleteKeyword(0,\"<c:out value='${list.idx }'/>\");' href='javascript:void(0)'><img class='btn_remove_keyword' src='/images/common/del_bt_bl.png' width=14 height=14/></a></span>");			resultHtmlArr.push("<span style='width:100px;' id='keywordSpan${list.idx}'><c:out value='${list.user_name }'/>(<c:out value='${list.use_id }'/>)</span><span id='keywordDelBtn${list.idx}' class='keywordDelBtn'>");			$("#keywordTarget<c:out value='${list.idx }'/>").html(resultHtmlArr.join(""));			$("#USE_ID<c:out value='${list.idx }'/>").val(use_id);			use_id="";			resultHtmlArr = [];		}	</c:forEach>		});$(function(){	<c:forEach var="list" items="${R_MAP.chargerList}" varStatus="status">		var keywordMap = {};		keywordMap.label = "<c:out value='${list.user_nm}'/>(<c:out value='${list.user_id}'/>)";		keywordMap.idx = "<c:out value='${list.user_id}'/>";		keywordsList.push(keywordMap);	</c:forEach>	var resultHtmlArr = [];	var keywordIdx;	<c:forEach var="list" items="${R_MAP.selectList}" varStatus="status">	var idx = "<c:out value='${list.idx}'/>";	$("#keyword"+idx).autocomplete({		source: keywordsList,		select : function(event, ui) {			var selectIdx = $("*:focus").attr("name").replace("keyword","");			fn_deleteKeyword(0,selectIdx);			resultHtmlArr.push("<span style='width:100px;' id='keywordSpan"+selectIdx+"'>"+ui.item.value+"</span><span id='keywordDelBtn"+selectIdx+"' class='keywordDelBtn'><a onclick='javascript:fn_deleteKeyword(0,\""+selectIdx+"\");' href='javascript:void(0)'><img class='btn_remove_keyword' src='/images/common/del_bt_bl.png' width=14 height=14/></a></span>");			$("#keywordTarget"+selectIdx).html(resultHtmlArr.join(""));			resultKeyword = ui.item.value;			$("#keyword"+selectIdx).val(resultKeyword);			$("#USE_ID"+selectIdx).val(ui.item.idx);			ui.item.value="";			ui.item.idx="";			resultHtmlArr = [];			return;		},		minLength: 1,		focus : function(event, ui) {			return false;		}	});	</c:forEach>		fn_deleteKeyword = function(idx, value) {		resultHtmlArr[idx] = "";		$("#keywordTarget"+value).children().remove();		$("#keywordTarget"+value).html(resultHtmlArr.join(""));		var tmpKeyword = resultKeyword.replace(value,"");		var tmpKeyword1 = tmpKeyword.replace(",,",",");		var lastChar = tmpKeyword1.charAt(tmpKeyword1.length-1);		var firstChar = tmpKeyword1.charAt(0);		if(lastChar == ",") {			tmpKeyword1 = tmpKeyword1.substr(0, tmpKeyword1.length-1);		}		if(firstChar == ",") {			tmpKeyword1 = tmpKeyword1.substr(1);		}		resultKeyword = tmpKeyword1;		$("#USE_ID"+value).val("");	};		$("#keyword").autocomplete({		source: keywordsList,		select : function(event, ui) {			resultHtmlArr.push("<span style='width:100px;' id='keywordSpan'>"+ui.item.value+"</span><span id='keywordDelBtn' class='keywordDelBtn'><a onclick='javascript:fn_deleteInsKeyword(0,\""+ui.item.idx+"\");' href='javascript:void(0)'><img class='btn_remove_keyword' src='/images/common/del_bt_bl.png' width=14 height=14/></a></span>");			$("#keywordTarget").html(resultHtmlArr.join(""));			resultKeyword = ui.item.value;			ins_use_id = ui.item.idx;			$("#keyword").val(resultKeyword);			$("#USE_ID").val(ins_use_id);			ui.item.value="";			ui.item.idx="";			ins_use_id="";			resultHtmlArr = [];			return;		},		minLength: 1,		focus : function(event, ui) {			return false;		}	});		fn_deleteInsKeyword = function(idx, value) {		resultHtmlArr[idx] = "";		$("#keywordTarget").children().remove();		$("#keywordTarget").html(resultHtmlArr.join(""));		var tmpKeyword = resultKeyword.replace(value,"");		var tmpKeyword1 = tmpKeyword.replace(",,",",");				var lastChar = tmpKeyword1.charAt(tmpKeyword1.length-1);		var firstChar = tmpKeyword1.charAt(0);		if(lastChar == ",") {			tmpKeyword1 = tmpKeyword1.substr(0, tmpKeyword1.length-1);		}		if(firstChar == ",") {			tmpKeyword1 = tmpKeyword1.substr(1);		}		resultKeyword = tmpKeyword1;		$("#USE_ID").val("");	};});		//글등록처리페이지이동var fn_searchList = function(pageNo) {		var frm = document.listfrm;		frm.pageIndex.value=pageNo;		frm.submit();	};function Go_wrin(){  su_form=document.regfrm;	// 제목체크	if( isEmpty(document.getElementsByName("AC_IP")[0].value) ) {		alert( "아이피를 입력하셔야 합니다." );		document.getElementsByName("AC_IP")[0].focus();		return;	}else{		if(getLength(document.getElementsByName("AC_IP")[0].value) > 15){			lenalert("아이피", 15, 2);			document.getElementsByName("AC_IP")[0].focus();			return;		}				var ipstr = $("form[name=regfrm]").find("input[name=AC_IP]").val();		var ipstr_sp = ipstr.split(".");		var rescnt = ipstr.match(/[.]/gi);		if(rescnt==null){			alert("아이피가 형식에 맞지않습니다.");			return;		}else{			if(rescnt.length!=3){				alert("아이피가 형식에 맞지않습니다.");				return;							}		}				for(var i=0;i<ipstr_sp.length;i++){			if(ipstr_sp[i]!=undefined && ipstr_sp[i]!=null && ipstr_sp[i]!=''){				if(isNum(ipstr_sp[i])){					alert("아이피는 숫자와 .만 입력해주세요");					return;				}							}else{				alert("아이피는 ipv4형식으로 입력해주세요");				return;							}		}	}		if( isEmpty($("#USE_ID").val()) ) {		alert( "담당자를 선택하셔야 합니다." );		$("#USE_ID").focus();		return;	}	  su_form.target = "successIframe";  su_form.pstate.value='C';  su_form.action='<%=RequestURL%>';  su_form.submit();  su_form.target = "";}//글수정처리페이지이동function Go_modin(idx){  su_form=document.listfrm;	// 제목체크	if( isEmpty(document.getElementsByName("AC_IP"+idx)[0].value) ) {		alert( "아이피를 입력하셔야 합니다." );		document.getElementsByName("AC_IP"+idx)[0].focus();		return;	}else{		if(getLength(document.getElementsByName("AC_IP"+idx)[0].value) > 15){			lenalert("아이피", 15, 2);			document.getElementsByName("AC_IP"+idx)[0].focus();			return;		}				var ipstr = $("form[name=listfrm]").find("input[name=AC_IP"+idx+"]").val();		var ipstr_sp = ipstr.split(".");		var rescnt = ipstr.match(/[.]/gi);		if(rescnt==null){			alert("아이피가 형식에 맞지않습니다.");			return;		}else{			if(rescnt.length!=3){				alert("아이피가 형식에 맞지않습니다.");				return;							}		}				for(var i=0;i<ipstr_sp.length;i++){			if(ipstr_sp[i]!=undefined && ipstr_sp[i]!=null && ipstr_sp[i]!=''){				if(isNum(ipstr_sp[i])){					alert("아이피는 숫자와 .만 입력해주세요");					return;				}							}else{				alert("아이피는 ipv4형식으로 입력해주세요");				return;							}		}			}	if( isEmpty($("#USE_ID"+idx).val()) ) {		alert( "담당자를 선택하셔야 합니다." );		$("#USE_ID"+idx).focus();		return;	}  su_form.target = "successIframe";  su_form.sidx.value = idx;  su_form.pstate.value='U';  su_form.action='<%=RequestURL%>';  su_form.submit();  su_form.target = "";}//글삭제처리페이지이동function Go_delin(idx){  su_form=document.listfrm;  if(!confirm("삭제하시겠습니까?")){	  return;  }  su_form.target = "successIframe";  su_form.sidx.value = idx;  su_form.pstate.value='D';  su_form.action='<%=RequestURL%>';  su_form.submit();  su_form.target = "";}//]]></script>