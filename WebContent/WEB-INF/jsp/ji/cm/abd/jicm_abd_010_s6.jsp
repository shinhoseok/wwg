<%--/*=================================================================================*//* 시스템            : JRCMS 시스템 SYSTEM/* 프로그램 아이디   : /WEB-INF/jsp/ji/cm/abd/jicm_abd_010_s6.jsp /* 프로그램 이름     : jicm_abd_010_s6    /* 소스파일 이름     : jicm_abd_010_s6.jsp/* 설명              : SYSTEM 게시판관리 목록페이지 FAQ/* 버전              : 1.0.0/* 최초 작성자       : 이금용/* 최초 작성일자     : 2016-11-16/* 최근 수정자       : 이금용/* 최근 수정일시     : 2016-11-16/* 최종 수정내용     : 최초작성/*=================================================================================*/--%><%@page pageEncoding="utf-8"%><%Map rtn_page_List = new HashMap();List rtn_tmp_List = new ArrayList();List code_select_List = new ArrayList(); // 셀렉트박스 생성용 코드리스트Map rtn_row_map2 = new HashMap();rtn_page_List = (Map)rtn_Map.get("PageListABD"); // 조회된 페이지 리스트rtn_tmp_List = (List)rtn_page_List.get("setList"); // 조회된 페이지 리스트String ssidx = (String)rtn_Map.get("sidx");int j = 0;int k = 0;int list_title_cnt =1;int etc_chk_cnt = 0;int TotalCount = Integer.parseInt(String.valueOf(rtn_page_List.get("setTotalCount")),10);int TotalPageCount = Integer.parseInt(String.valueOf(rtn_page_List.get("setTotalPageCount")),10);%><script language="javascript" src="<%=con_root%>/js/com-file.js"></script><form name="listfrm" id="listfrm" method="post" onSubmit='return false;srchCheck();' ><!-- 조회된등록수: <%=rtn_page_List.get("setTotalCount")%> 건<br />--><input type="hidden" name="scode" value="<%=scode%>" id="scode" title="사이트코드" /><input type="hidden" name="pcode" value="<%=pcode%>" id="pcode" title="페이지코드"  /><input type="hidden" name="pstate" value="<%=pstate%>" id="pstate" title="페이지상태"  /><input type="hidden" name="curr_page" value="<%=curr_page%>" id="curr_page"  title="현재페이지번호"  /><input type="hidden" name="show_rows" value="<%=show_rows%>" id="show_rows"  title="현재페이지당데이터수"  /><input type="hidden" name="totalpage" value="" id="totalpage"  title="전체페이지수"  /><input type="hidden" name="sidx" value="">			<h5 class="main_title">				<strong><%=M_PATH_STR.substring(M_PATH_STR.lastIndexOf("::")+2)%></strong>				<p class="copy">전력데이터 개방 포털시스템 <%=M_PATH_STR.substring(M_PATH_STR.lastIndexOf("::")+2)%>입니다.</p>			</h5>						<!--search-->			<div class="search_A0">				<fieldset>					<legend>게시물검색</legend>					<p>						<label for="se_field" class="hide">검색조건</label>						<select class="select_type01" name="se_field" id="se_field" title="검색조건 선택">				        	<option value="" <%if(se_field.equals("")){ %>selected="selected"<%} %> id="sc_all">==전체==</option>				    		<option value="B_TITLE" <%if(se_field.equals("B_TITLE")){ %>selected="selected"<%} %> id="sc_title">제목</option>				            <option value="B_CONTENTS" <%if(se_field.equals("B_CONTENTS")){ %>selected="selected"<%} %> id="sc_writer">내용</option>						</select>						<label for="se_text" class="hide">검색어</label>						<input type="text" class="input_type01 w_250" id="se_text" name="se_text" maxlength="50" value="<%=se_text %>" Onkeypress="srchCheck()" onKeyUp="sechnotin();" title="검색어 입력"  placeholder="검색어를 입력하세요" />					</p>					<p>						<button class="btn_2 size_search search_btn" id="btn_search">검색</button>					</p>				</fieldset>			</div>			<!--//search-->			<div class="board_A0_F">				<p class="count" id="page_info_id"></p>				<div class="accordion" id="list_data_obj">					<!-- 					데이터출력부분					-->				</div>			</div>			<!--//board_A0_list-->						<div class="button a_r mat_30">				<a href="#" class="btn_2 size_n" onclick='reset_list();return false;' style="display:none;"><strong>목록보기</strong></a>			</div>							<% 				//페이징 관련 변수설정				String formname = "document.listfrm";				// from 이름 ;; document.form[0];				String action = RequestURL; 						// action 				String formele = "curr_page";				String pagestr = CM_Util.PageindexS(TotalCount,curr_page,TotalPageCount,curr_page,formname,action,formele,img_url+"/cmsadmin");			%>						<!--paging-->			<div class="paging">		    <%=pagestr%>		    </div>		    <!-- //paging -->		     	<!--목록시작--><script type="text/javascript">var searchYn = false;$(function(){	refreshAbd();});//TODO : refreshAbdfunction refreshAbd(){		//검색어가 있을시 목록보기 버튼을 보여준다 2018.07.21	if($('#se_text').val()==''){		$('.button>.btn_2').hide();	}else{		$('.button>.btn_2').show();	}		if (getLength($("#se_text").val()) > 50) {		alert("\n검색어는 한글 25자 이상을 입력할수 없습니다.");		$("#se_text").val("");		$("#se_text").focus();  		return false;	}					if (char_chk($("#se_text").val(),"'") == false) {		alert("\n검색어는 '을 포함할 수 없습니다.");		$("#se_text").val("");		$("#se_text").focus(); 		return false;	}		$("#pstate").val("X");	var params =  $("form[name=listfrm]").serialize();	$("#list_data_obj").html("");	CmopenLoading();	 $.ajax({        type: "post",        url: "<c:url value='/cmsajax.do'/>",        data: params,        async: false,        dataType:"json",        timeout: 3000,        error: function (jqXHR, textStatus, errorThrown) {            // 통신에 에러가 있을경우 처리할 내용(생략가능)        	alert("네트웍장애가 발생했습니다. 다시시도해주세요");        	CmcloseLoading();                  },			                     success: function(data){           if(data.result==true){				if(data.rows!=""){					$("#page_info_id").html("[총 <b>"+data.records+"</b>건, <b>"+data.page+"</b>/"+data.total+"]");					AbdListToHtml(data);				}else{					$(".paging").html(PageindexS("0",$("#show_rows").val(),"0",$("#curr_page").val(),"document.listfrm","<%=RequestURL%>","curr_page","<%=img_url%>/cmsadmin"));					$("#page_info_id").html("[총 <b>0</b>건, <b>0</b>/0]");					$("#list_data_obj").append("<div class='no_text'>등록된 FAQ가 없습니다.</div>");				}                      }else{	        	alert(data.TRS_MSG);	        	top.location.href="<%=RequestURL%>";	        	           }			          	$("#pstate").val("L");          	CmcloseLoading();        }	});	}//TODO : AbdListToHtmlfunction AbdListToHtml(res_data){	var hi=0;	var hj=0;	var list_html = "";	var desc_html = "";	var arti_No = 0;	var rows = res_data.rows;	for(hi=0;hi<rows.length;hi++){		list_html = "<dl>";		list_html = list_html+"<dt><span class=\"num\">"+(hi+1)+"</span>";		list_html = list_html+cutStr(rows[hi].data_title,300)+"<i></i></dt>";		if(rows[hi].data_desc != null){			console.log(rows[hi].data_desc);			list_html = list_html+"<dd>"+(rows[hi].data_desc).replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&amp;/gi,"&").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&amp;/gi,"&")+"</dd>";		}		list_html = list_html+"<dl>";				$("#list_data_obj").append(list_html);					}// FOR 종료			// 페이징을 생성한다	//console.log("res_data.record:"+res_data.records+":res_data.page:"+res_data.page+":$(#show_rows).val():"+$("#show_rows").val()+":hi:"+hi);	$(".paging").html(PageindexS(res_data.records,$("#show_rows").val(),res_data.total,$("#curr_page").val(),"document.listfrm","<%=RequestURL%>","curr_page","<%=img_url%>/cmsadmin"));}</script></form>   <!--목록끝--><script type='text/javascript'>//<![CDATA[	$(document).ready(function() {		/*accordion*/	//$(".accordion > dl").click(function(e){	$(document).on('click', '.accordion > dl',function(e){		e.preventDefault();		if($(this).hasClass('active')) {			$(this).removeClass('active');			$(this).find("dd").slideUp(100);			$(".accordion i").removeClass('on');		} else {			$(".accordion > dl").removeClass('active');			$(".accordion i").removeClass('on');			$(this).find("i").addClass('on');			$(this).addClass('active');			$(".accordion > dl > dd").parent().not(this).find("dd").slideUp(100);			$(this).find("dd").slideToggle(100);		}	});	/*//accordion*/				$("#btn_search").click( function() {		if(typeof refreshGrid === 'function'){		}else{			// 검색버튼을 클릭한경우는 데이터를 지운다						$("#curr_page").val("1");			refreshAbd();		}	});	});//목록보기function reset_list(){	  su_form=document.listfrm;	  su_form.se_field.value='';	  su_form.se_text.value='';	  refreshAbd();}function sechnotin(){	   var m_Sp = /[$\\@\\\#%\^\&\*\(\)\[\]\+\_\{\}\`\~\=\|\<\>]/;	   var m_val = document.getElementsByName("se_text")[0].value;	   var strLen = m_val.length;	   var m_char = m_val.charAt((strLen) - 1);	   if(m_char.search(m_Sp) != -1) {	      alert("특수문자는 사용할수없습니다.");	      document.getElementsByName("se_text")[0].value = "";	      document.getElementsByName("se_text")[0].focus();	      return;	   }}function srchCheck(){	if(event.keyCode==13){		$("#btn_search").trigger("click");	}}//#####문자체크function char_chk(str,chk){	for(i = 0; i < str.length; i++){		c = str.charAt(i);		if(c == chk){			return false;		}	}}function getadddate(datestr,flag, num){	var iyyyy = parseInt(datestr.substring(0,4),10);	var imm	  = parseInt(datestr.substring(4,6),10);	var idd	  = parseInt(datestr.substring(6,8),10);		var ret_date = new Date();	//console.log(iyyyy+"::"+imm+"::"+idd);	if(flag=="+"){		ret_date = new Date(iyyyy,imm,idd+num);		//console.log("ret_date+::"+ret_date);	}else{		ret_date = new Date(iyyyy,imm,idd-num);		//console.log("ret_date-::"+ret_date);	}	//console.log("ret_date  ::"+ret_date.getYear()+"::"+(ret_date.getMonth()+1)+"::"+ret_date.getDate());	return ret_date.getFullYear()+""+(ret_date.getMonth()>9?ret_date.getMonth():"0"+ret_date.getMonth())+""+(ret_date.getDate()>9?ret_date.getDate():"0"+ret_date.getDate());}//TODO : PageindexSfunction PageindexS(TotalCount, show_rows,		TotalPageCount, curr_page, formname, action,		formele, imgcon_root){	var pagestr = "";	var reapAmount= 10;	var indexSize = 10;			var currs_page = parseInt(curr_page,10);	var fromPage= ((currs_page) - ((currs_page - 1) % indexSize));       if(TotalPageCount==0){    	   TotalPageCount = 1;       }       var toPage = TotalPageCount;       if (toPage > (fromPage + indexSize - 1)){  	       toPage = (fromPage + indexSize - 1);  	   }              var prevPage =0;      var reapPrevPage =0;      var prevDisabled = false;       var reapPrevDisabled = false;       if(0<(currs_page-1)){         prevPage = currs_page-1;      }else{         prevDisabled = true;      }      if(0<(currs_page-reapAmount)){         reapPrevPage = currs_page-reapAmount;      }else{         reapPrevDisabled = true;      }      pagestr = pagestr +"<a href=\"#\" onclick=\"goPagination('"+formname+"','"+action+"','1','"+formele+"');return false;\" class=\"boxFirst\">"    		  + "처음 페이지로<span></span></a>";            if(!prevDisabled){      	  pagestr = pagestr +"<a href=\"#\" onclick=\"goPagination('"+formname+"','"+action+"','"+prevPage+"','"+formele+"');return false;\" class=\"boxPrev\">"	    		+ "이전 페이지로</a>";      }else{    	  pagestr = pagestr +"<a href=\"#\" onclick=\"return false;\" class=\"boxPrev\">이전 페이지로</a>";	    	        }            for(var k=fromPage;k<=toPage;k++){     	  var index = k;    	  var isCurrentPage = (index == currs_page);  		    	  if(isCurrentPage){    		  pagestr = pagestr +"\n<a href=\"#\" onclick=\"goPagination('"+formname+"','"+action+"','"+index+"','"+formele+"');return false;\" class='boxnow'>"+index+"</a>";    	  }      	  if(!isCurrentPage){    		  pagestr = pagestr +"\n<a href=\"#\" onclick=\"goPagination('"+formname+"','"+action+"','"+index+"','"+formele+"');return false;\" >"+index+"</a>";    	  }    	      	  if(k!=toPage){    		  pagestr = pagestr +" ";    	  }      }            var nextPage =0;      var reapNextPage =0;      var nextDisabled = false;       var reapNextDisabled = false;       if((currs_page+1)<=TotalPageCount){         nextPage = currs_page+1;      }else{         nextDisabled = true;      }      if((currs_page+reapAmount)<=TotalPageCount){         reapNextPage = currs_page+reapAmount;      }else{         reapNextDisabled = true;      }      if(!nextDisabled){      	  pagestr = pagestr +"<a href=\"#\" onclick=\"goPagination('"+formname+"','"+action+"','"+nextPage+"','"+formele+"');return false;\" class=\"boxNext\">"		    		+ "다음 페이지로</a>";    	        }else{	      pagestr = pagestr +"<a href=\"#\" onclick=\"return false;\" class=\"boxNext\">다음 페이지로</a>";       }            pagestr = pagestr +"<a href=\"#\" onclick=\"goPagination('"+formname+"','"+action+"','"+TotalPageCount+"','"+formele+"');return false;\" class=\"boxLast\">"    		  + "마지막 페이지로<span></span></a>";	      		return pagestr;}<%//게시판 종류가 자유형일경우 등록버튼을 보여준다//게시판 종류는 000010:공지형 , 000011:자유형 , 000012:답변형, 000013:갤러리형 , 000014:통합형, 000051:일정형, 000052:FAQ형, 000052:동영상형if(BOARD_TY.equals("000011") || BOARD_TY.equals("000012")){%>	function Go_reg(){		  su_form=document.listfrm;		  su_form.method='post';		  su_form.pstate.value='CF';		  su_form.action='<%=RequestURL%>';		  		  su_form.submit();		  su_form.target = "";			}<%}//게시판 종류가 자유형일경우 등록버튼을 보여준다%>//]]></script>