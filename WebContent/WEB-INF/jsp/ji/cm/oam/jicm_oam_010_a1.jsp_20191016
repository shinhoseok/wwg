<%--/*=================================================================================*//* 시스템            : 시스템 SYSTEM/* 프로그램 아이디   : /WEB-INF/jsp/ji/cm/oam/jicm_oam_010_a1/* 프로그램 이름     : jicm_oam_010_a1    /* 소스파일 이름     : jicm_oam_010_a1.jsp/* 설명              : SYSTEM 조직관리/* 버전              : 1.0.0/* 최초 작성자       : 이금용/* 최초 작성일자     : 2014-02-05/* 최근 수정자       : 이금용/* 최근 수정일시     : 2014-02-05/* 최종 수정내용     : 최초작성/*=================================================================================*/--%><%@page pageEncoding="utf-8"%><%@include file="/WEB-INF/jsp/cm/CmCommon.jsp"%><!-- 공통 jsp 파일--><%String curr_page = HtmlTag.returnString((String)request.getAttribute("curr_page"),"1");String show_rows = HtmlTag.returnString((String)request.getAttribute("show_rows"),"10");String sidx = HtmlTag.returnString((String)request.getAttribute("sidx"),"0");String se_code	= HtmlTag.returnString((String)request.getAttribute("se_code"),"000000");String se_lv	= HtmlTag.returnString((String)request.getAttribute("se_lv"),"1");String sel_num	= HtmlTag.returnString((String)request.getAttribute("sel_num"),"");String se_code_up_c	= HtmlTag.returnString((String)request.getAttribute("se_code_up_c"),"000000");ArrayList se_code_arr =  new ArrayList();if(!sel_num.equals("")){	for(int r=0;r<=Integer.parseInt(sel_num,10);r++){		se_code_arr.add(HtmlTag.returnString((String)request.getAttribute("dto_SELMENU_"+r),""));	}}%><!--내용시작  --><style>/* .ui-jqgrid .ui-jqgrid-htable th div {    height:17px;} */.th.ui-th-column div {  height:auto!important;}.ui-jqgrid .ui-jqgrid-htable th div {	white-space:normal!important;	height:auto!important;	padding:2px;}</style><script language="javascript" src="<%=con_root%>/js/com-tree.js"></script>					<script type="text/javascript">var searchYn = false;//TODO : $(function()$(function(){		// 조직트리	var cmtreeval = new Array();	//init tree	$.fn.cmtree({		 id			: '#cmtree_data' 		 ,treeAreaId : "#treeArea"		 ,treeMenuId : "#treeMenu"		 ,treeHeight : ($("#content").height()-10)+"px"		 ,treeWidth  : "200px"		 ,treemHeight : ($("#content").height()-100)+"px"		 ,treemWidth : "160px"	 		 ,checkBoxYn: true		 ,treeArr   : cmtreeval		 ,onClickTitlefn: "treeClickTitle01"		 ,treeRelComboId : "org_select_group"		 ,treeRelComboboxId : "org_option"		 ,treeImgPath : "<%=img_url%>"	});		//조직 리스트	var cols =[		{label:'조직<br /> 일련번호'	,name:'org_seqno'        ,index:'org_seqno'         ,align:'center'  ,width:'80'   ,hidden:true }	   ,{label:'조직코드'           	,name:'org_cd'           ,index:'org_cd'            ,align:'center'  ,width:'120'  ,hidden:false  ,frozen:true }	   ,{label:'조직명'           		,name:'org_nm'           ,index:'org_nm'            ,align:'left'  	 ,width:'180'  ,hidden:false  ,frozen:true }	   ,{label:'상위 조직코드'      	,name:'uppo_org_cd'      ,index:'uppo_org_cd'       ,align:'center'  ,width:'120'  ,hidden:true }	   ,{label:'상위 조직명'        	,name:'tree_uppo_cd_nm'  ,index:'tree_uppo_cd_nm'   ,align:'center'  ,width:'180'  ,hidden:false }	   ,{label:'조직유형<br /> 코드'  ,name:'org_ty_cd'        ,index:'org_ty_cd'         ,align:'center'  ,width:'100'   ,hidden:true  }	   ,{label:'조직유형'           	,name:'org_ty_cd_nm'     ,index:'org_ty_cd_nm'      ,align:'center'  ,width:'120'  ,hidden:false }	   ,{label:'정렬 순번'     		,name:'org_sort_no'      ,index:'org_sort_no'       ,align:'center'  ,width:'80'   ,hidden:false }	   ,{label:'조직 비고'  			,name:'org_desc'         ,index:'org_desc'          ,align:'center'  ,width:'300'  ,hidden:false }	   ,{label:'사용시작일'           	,name:'use_st_ymd'       ,index:'use_st_ymd'        ,align:'center'  ,width:'100'  ,hidden:true }	   ,{label:'사용종료일'           	,name:'use_end_ymd'      ,index:'use_end_ymd'       ,align:'center'  ,width:'100'  ,hidden:true }	   ,{label:'key'	     			,name:'org_seqno'		 ,index:'org_seqno'     	,align:'center'  ,width :'1'   ,hidden:true }	   ]	//init grid	var grid = com.grid.init({		 id			: '#jqGrid' 		,viewrecords: true		,height		: 364		,autowidth  : true		,rowList	: 1000		,rowNum		: 100		,shrinkToFit : false		,scroll 	: 1	    ,sortable:false	    ,editable:false	    ,ajaxGridOptions: { contentType: "application/json;charset=utf-8" }		,gridComplete: function(){			mergeCellcomplet($(this));		}		,loadComplete: function(data){			// 로드 데이타 갯수 체크			if(searchYn){				insertfInit();				isLoadData(data);							}							}			,onSelectRow: function(rowid) { // row를 선택했을때 액션.						var ret = $("#jqGrid").jqGrid("getRowData",rowid); // ret는 선택한 row 값을 쥐고있는 객체다.			$("#iorg_nm").val(ret.org_nm);// 조직명			$("#iorg_sort_no").val(ret.org_sort_no);// 조직순번			$("#iuse_st_ymd").val(ret.use_st_ymd);// 조직사용시작일			$("#iuse_end_ymd").val(ret.use_end_ymd);// 조직사용종료일			$("#iorg_desc").val(ret.org_desc);// 조직비고			//$("#iorg_area_cd > option[value="+ret.org_area_cd+"]").attr("selected", true);//권역			//$("#ibrnch_org_cd > option[value="+ret.brnch_org_cd+"]").attr("selected", true);//지사			$("#iorg_cd").val(ret.org_cd);// 조직코드			$("#iorg_seqno").val(ret.org_seqno);// 조직일련번호			$("#imorg_cd").val("");// 이동될 상위 조직코드			//$("#iorg_rcv_excpt_cd > option[value="+ret.org_rcv_excpt_cd+"]").attr("selected", true);//조직인수제외여부			$("#iuppo_org_cd").val(ret.uppo_org_cd);// 상위 조직코드			$("#ihorg_sort_no").val(ret.org_sort_no);// 원조직순번						//$("#iorg_ty_cd > option[value="+ret.org_ty_cd+"]").attr("selected", true);//조직유형			$("#iorg_ty_cd").val(ret.org_ty_cd);//조직유형												$("#spbtn_del").hide();			// 기준일자가 현재일자보다  이전이면 이동버튼을 보여주지 않는다			//alert(parseInt($("#base_ymd").val().replace(/-/g,"")));			if(parseInt($("#base_ymd").val().replace(/-/g,"")) < <%=curDate.substring(0,4)+""+curDate.substring(4,6)+""+curDate.substring(6,8)%> ){				$("#spbtn_move").hide();				$("#btn_save").hide();							}else{				$("#spbtn_move").show();			}						$("#spbtn_init").show();			chgTab(1);												//var value1 = ret.std_info_seqno; // 이런식으로 값을 가져올 수 있다.			//refreshsubGrid(value1);					}		,gridComplete: function(){			//alert(jQuery("#jqGrid").jqGrid('getGridParam','records'));			//jQuery("#jqGrid").setGridParam({rowNum:jQuery("#jqGrid").jqGrid('getGridParam','records')});			}			,custom : { //custom			 cols : cols //컬럼정보 - 필수!			,navButton : {				excel : {					exportName	: $('.con_title>h3').text().trim() //엑셀다운로드시 사용할 파일명				}			}		}	});		    /* 그리드 크기를 조절할 수 있도록 한다. */        jQuery("#jqGrid").jqGrid('gridResize',{});        jQuery("#jqGrid").jqGrid('setFrozenColumns');            //resizeJqGridWidth("jqGrid", "jqGridDiv", 400);        //jQuery("#jqGrid").css("width", "400px");    	    /*  필드별 검색어 입력창을 숨기거나 보여지게한다. */    	    jQuery("#jqGrid").jqGrid('navButtonAdd',"#jqGridPager",{caption:"Toggle",title:"Toggle Search Toolbar", buttonicon :'ui-icon-pin-s',	        onClickButton:function(){	        	grid[0].toggleToolbar();	        } 	    });	    /* 각 필드별 검색어 입력창에 입력된 내용를 지운다. */	    jQuery("#jqGrid").jqGrid('navButtonAdd',"#jqGridPager",{caption:"Clear",title:"Clear Search",buttonicon :'ui-icon-refresh',	        onClickButton:function(){	        	grid[0].clearToolbar();	        } 	    });	    /*  필드별 검색어 입력창 */    		//jQuery("#jqGrid").jqGrid('navGrid','#ptoolbar',{del:false,add:false,edit:false,search:false});		//jQuery("#jqGrid").jqGrid('filterToolbar',{stringResult: true,searchOnEnter : false});								//저장		$("#btn_save").click(function(e){			//checkboxId			//var checkBoxId = ["test_checkbox","test_checkbox1"]; //사용 textBOx 배열로 전달 			//if(!validation("listfrm")) return false; //필수 체크						//alert(parseInt(jQuery("#jqGrid").jqGrid('getGridParam','records'))+'---'+parseInt($("#iorg_seqno").val()));			//alert((parseInt($("#iorg_seqno").val()) < 1));			//return;									if( $("#iorg_nm").val()=="" ){				alert('조직명을 입력해 주세요');				$("#iorg_nm").focus();				return;			}			/* 			if(isEmpty($("#iuse_st_ymd").val()) ){				alert('기간 시작일을 입력해 주세요');				$("#iuse_st_ymd").focus();				return;			}						if(isEmpty($("#iuse_end_ymd").val()) ){				alert('기간 종료일을 입력해 주세요');				$("#iuse_end_dt").focus();				return;			} */						// 기간이 둘다 입력된경우 확인			if(!isEmpty($("#iuse_st_ymd").val()) && !isEmpty($("#iuse_end_ymd").val()) ){				if(parseInt(StrreplaceAll($("#iuse_st_ymd").val(), "-",""),10) > parseInt(StrreplaceAll($("#iuse_end_ymd").val(), "-",""),10)){					alert("기간 시작일이 종료일 이후여야합니다");					$("#iuse_st_ymd").focus();					return false;				}			}						// 등록이면			if($("#iorg_seqno").val()==""){				if(parseInt(jQuery("#jqGrid").jqGrid('getGridParam','records'))+1 <  parseInt($("#iorg_sort_no").val()) ){					alert("정렬순번은 0보다 크고 현재 데이터갯수"+jQuery("#jqGrid").jqGrid('getGridParam','records')+"개를 초과할수 없습니다.");					return;				}							// 수정이면			}else{				if(parseInt(jQuery("#jqGrid").jqGrid('getGridParam','records')) <  parseInt($("#iorg_sort_no").val()) ){					alert("정렬순번은 0보다 크고 현재 데이터갯수"+jQuery("#jqGrid").jqGrid('getGridParam','records')+"개를 초과할수 없습니다.");					return;				}							}						   $("#pstate").val("C");			   				//var params = jQuery('form').serialize();				var params =  $("form[name=listfrm]").serialize();				//alert(params);				CmopenLoading();									 $.ajax({			             type: "post",			             url: "<c:url value='/cmsajax.do'/>",			             data: params,			             async: false,			             dataType:"json",			             timeout: 3000,			             error: function (jqXHR, textStatus, errorThrown) {			                 // 통신에 에러가 있을경우 처리할 내용(생략가능)			    	        	alert("네트웍장애가 발생했습니다. 다시시도해주세요");             			             },			             			             success: function(data){			               if(data.result==true){			                	alert('저장 되었습니다.');			                	refreshAll();			               }else{			            	   alert(data.TRS_MSG);			               }			               setTimeout(CmcloseLoading,800);			               $("#pstate").val("L");			               			             }			    });		});					//이동		$("#spbtn_move").click(function(e){			//checkboxId			//var checkBoxId = ["test_checkbox","test_checkbox1"]; //사용 textBOx 배열로 전달 			if(!validation("listfrm")) return false; //필수 체크			var rtnArr = $.fn.cmtree.chkTreeArr();			//alert(rtnArr.length);			if(rtnArr.length<1){				alert("트리에서 이동될 상위 조직을 선택해 주세요");				return;			}							if(rtnArr.length>1){				alert("트리에서 이동될 상위 조직을 한개만 선택해 주세요");				return;			}								$("#imorg_cd").val(rtnArr[0][1]);// 이동될 상위 조직코드			//alert(rtnArr[0][1]+":::"+$("#imorg_cd").val());			//return;						   $("#pstate").val("C");			   				//var params = jQuery('form').serialize();				var params =  $("form[name=listfrm]").serialize();				//alert(params);				CmopenLoading();									 $.ajax({			             type: "post",			             url: "<c:url value='/cmsajax.do'/>",			             data: params,			             async: false,			             dataType:"json",			             timeout: 3000,			             error: function (jqXHR, textStatus, errorThrown) {			                 // 통신에 에러가 있을경우 처리할 내용(생략가능)			    	        	alert("네트웍장애가 발생했습니다. 다시시도해주세요");             			             },				             			             success: function(data){			               if(data.result==true){			                	alert('이동 되었습니다.');			                	refreshAll();			               }else{			            	   	alert(data.TRS_MSG);			               }			               setTimeout(CmcloseLoading,800);			               $("#pstate").val("L");			               			             }			    	});		});					//삭제		$("#spbtn_del").click(function(e){			if(confirm("삭제하시겠습니까?")){			}else{				return;			}							   $("#pstate").val("D");			   				//var params = jQuery('form').serialize();				var params =  $("form[name=listfrm]").serialize();				//alert(params);				CmopenLoading();									 $.ajax({			             type: "post",			             url: "<c:url value='/cmsajax.do'/>",			             data: params,			             async: false,			             dataType:"json",			             timeout: 3000,			             error: function (jqXHR, textStatus, errorThrown) {			                 // 통신에 에러가 있을경우 처리할 내용(생략가능)			    	        	alert("네트웍장애가 발생했습니다. 다시시도해주세요");             			             },				             			             success: function(data){			               if(data.result==true){			                	alert('삭제 되었습니다.');			                	refreshAll();			               }else{			            	   	alert(data.TRS_MSG);			               }			               setTimeout(CmcloseLoading,800);			               $("#pstate").val("L");			               			             }			    	});		});							//  차후 공통팝업으로 수정요망	$("#btn_org_search").click( function() {		popWinScroll("<c:url value='/cmsmain.do'/>?scode=000008&pcode=000037&dto_FUN_FN=setOrgAdd&pstate=PF1&multi_yn=Y&check_yn=Y", "orgWinPop", 500, 680);	});		//  차후 공통팝업으로 수정요망	$("#btn_orgsawon_search").click( function() {		popWinScroll("<c:url value='/cmsmain.do'/>?scode=000008&pcode=000038&dto_FUN_FN=setOrgSawonAdd&pstate=PF2&multi_yn=Y&check_yn=N", "orgSawonWinPop", 720, 680);	});		$("#btn_search").click( function() {		refreshAll();	});	$('#cod_yn').click(function(){        if ($("#cod_yn").is(":checked")) {         	$("#cod_used").val("Y");        } else {         	$("#cod_used").val("");        } 	}); 		$('#del_yn').click(function(){        if ($("#del_yn").is(":checked")) {         	$("#cod_del").val("Y");        } else {         	$("#cod_del").val("");        } 	}); 			CmopenLoading();		chgTab(0);	refreshTree();//트리조회		// 조직 셀렉트 박스를 만든다	$.fn.cmtree.treeRelComboboxMake('','', 0);		refreshGrid(false); //조회	setTimeout(grid_win_resizeAuto, 200);	CmcloseLoading();		$("#btn_excel").click(function(e){		//엑셀출력[화면,전체] - 파라미터(그리드명,엑셀구분[화면:"",전체:""],엑셀명)		excelDownload("jqGrid","","<%=M_PATH_STR.substring(M_PATH_STR.lastIndexOf("::")+2)%> 화면리스트", "<c:url value='/cmsmain.do'/>");			});			$("#btn_excelAll").click(function(e){				//엑셀출력[화면,전체] - 파라미터(그리드명,엑셀구분[화면:"",전체:"A"],엑셀명) - java 리스트쪽 구현해야함		excelDownload("jqGrid","A","<%=M_PATH_STR.substring(M_PATH_STR.lastIndexOf("::")+2)%> 전체리스트", "<c:url value='/cmsmain.do'/>");	});});//TODO : setOrgAdd// 조직 검색팝업 리턴값 셋팅function setOrgAdd(rtnArr){	var ri =0;	var set_str1="";	var set_str2="";	for(ri=0;ri<rtnArr.length;ri++){		set_str1=set_str1+rtnArr[ri][1];		set_str2=set_str2+rtnArr[ri][2];		if(ri < rtnArr.length-1){			set_str1=set_str1+",";			set_str2=set_str2+",";					}	}	$("#s_org_cd").val(set_str1);		//코드	$("#s_org_nm").val(set_str2);		//코드명	}//TODO : setOrgSawonAdd//조직사원 검색팝업 리턴값 셋팅function setOrgSawonAdd(rtnArr){		$("#s_org_cd").val(rtnArr[0].join(','));		//코드	$("#s_org_nm").val(rtnArr[1].join(','));		//코드명}//TODO : treechkofffunction treechkoff(){	var param_arr = new Array();	param_arr.push('0030');	param_arr.push('0031');		$.fn.cmtree.unchkTreeArr(param_arr);}//TODO : treechkonfunction treechkon(){	var param_arr = new Array();	param_arr.push('0030');	param_arr.push('0031');		$.fn.cmtree.chkedTreeArr(param_arr);}//조회 : 트리조회//TODO : refreshTreefunction refreshTree(){			//alert('refreshTree');	$("#pstate").val("XL2");	var params =  $("form[name=listfrm]").serialize();	//var params = jQuery('form').serialize();	//var params = com.frm.getParamJSON(document.listfrm);	//alert(params);	$.fn.cmtree.reload('#cmtree_data','<c:url value='/cmsajax.do'/>',params);	}//조회 : 전체조회//TODO : refreshAllfunction refreshAll(){	CmopenLoading();	refreshTree();	refreshGrid(false); //조회	insertfInit();	setTimeout(CmcloseLoading,800);}/* * @param string grid_id 사이즈를 변경할 그리드의 아이디 * @param string div_id 그리드의 사이즈의 기준을 제시할 div 의 아이디 * @param string width 그리드의 초기화 width 사이즈 *///TODO : resizeJqGridWidthfunction resizeJqGridWidth(grid_id, div_id, width){    // window에 resize 이벤트를 바인딩 한다.     $(window).bind('resize', function() {        // 그리드의 width 초기화        $('#' + grid_id).setGridWidth(width, false);        // 그리드의 width를 div 에 맞춰서 적용        $('#' + grid_id).setGridWidth($('#' + div_id).width()-70 , false); //Resized to new width as per window     }).trigger('resize');}//조회 : 그리드 조회//TODO : refreshGridfunction refreshGrid(isNotCheckVal){	var _frm = document.listfrm;	_frm.action='<%=RequestURL%>';	searchYn = true;		//validation	/*	if(!isNotCheckVal){		if($('#textfield',document.listFrm).chkForm({name:'검색어', length:'60', type:'number', nullCheck:true})){ return; }	}	*/	var params = getGridParamDatas();	//alert(params);jQuery("#jqGrid").setGridParam({rowNum:currentValue+10});	//alert(jQuery("#jqGrid").getGridParam('rowNum'));		//alert(jQuery("#jqGrid").jqGrid('getGridParam','rowNum'));	com.grid.reload('#jqGrid','<c:url value='/cmsajax.do'/>',params);	//jQuery("#jqGrid").setGridParam({rowNum:4000});	//alert(jQuery("#jqGrid").jqGrid('getGridParam','reccount'));	//alert(jQuery("#jqGrid").jqGrid('setGridParam',{rowNum:2000}));	//alert(jQuery("#jqGrid").jqGrid('getGridParam','rowNum'));	//var gridrecords = jQuery("#jqGrid").jqGrid('getGridParam','records');	//alert("gridrecords:"+gridrecords);}//TODO : cmtreechkCallfunction cmtreechkCall(){	var rtnArr = $.fn.cmtree.chkTreeArr();	var rtnArr_valstr = rtnArr[0].join(',');	var rtnArr_textstr = rtnArr[1].join(',');	alert(rtnArr_valstr+"----"+rtnArr_textstr);}//그리드 조회시 요청할 파라미터 object//TODO : getGridParamDatasfunction getGridParamDatas(){	var _params = com.frm.getParamJSON(document.listfrm);	var i = 0;	_params.pstate = 'XL1';	var sel_param = "";	//alert($("select[name^='org_option']").length);	if($("select[name^='org_option']").length > 1){		for(i=$("select[name^='org_option']").length;i>1;i--){			if($("#org_option"+(i-1)).val()!=""){				sel_param = $("#org_option"+(i-1)).val();				break;			}		}		if(sel_param=="" || sel_param==undefined){			sel_param = $("#org_option").val();		}		//alert(sel_param);		_params.sorg_cd = sel_param;	}else{		_params.sorg_cd = $("#org_option").val();	}		return _params;}//TODO : treeClickTitle01function treeClickTitle01(rtnArr){	//alert(rtnArr[1]+"---"+rtnArr[4]);	//0: TREE_SEQ, 1: TREE_CD, 2: TREE_NM, 3:TREE_UPPO_CD, 4: TREE_LEVEL, 5: TREE_NMS, 6: TREE_CDS, 7: TREE_SUB_CNT	//$.fn.cmtree.treeRelComboboxSet(rtnArr[1], rtnArr[4]);	//$.fn.cmtree.treeRelComboboxMake(rtnArr[1],'', rtnArr[4]);	$.fn.cmtree.selTreeParentAll(rtnArr[1], rtnArr[4]);//조직트리 해당 조직으로 선택	//$.fn.cmtree.treeRelComboboxMake(rtnArr[1],'', rtnArr[1]);			optionGroupToTree(rtnArr[6], rtnArr[4]);	//	//insertfInit();}function optionGroupToTree(tree_cds, tree_level){	// 역으로 찾아가며 처리한다	var ogi = 0;	//alert(tree_cds+"---"+tree_level);	var tree_cds_sp = tree_cds.split("::");	for(ogi=0;ogi<tree_cds_sp.length;ogi++){		$("select[name='org_option']").eq(ogi).val(tree_cds_sp[ogi]);		optionGroup($("select[name='org_option']").eq(ogi), ogi+1, "N", "","N");			}		// 그리드 조회	refreshGrid(false); //조회	}//TODO : optionGroupfunction optionGroup($this, lev, treeyn, treecode, gridreloadyn){	//alert($this.attr("id"));	if(treeyn=="Y"){		$this.val(treecode);		$.fn.cmtree.treeRelComboboxMake(treecode,'', lev);//하위 셀렉트박스 생성		$.fn.cmtree.selTreeParentAll(treecode, lev);//트리 해당 코드로 선택				}else{		if(isEmpty($this.val())){			if(lev>1){				//alert($("select[name='smatrtpcd']").eq(lev-2).val()+"----"+(lev-2));				$.fn.cmtree.treeRelComboboxMake($("select[name='org_option']").eq(lev-2).val(),'', lev-1);//하위 셀렉트박스 생성								$.fn.cmtree.selTreeParentAll($("select[name='org_option']").eq(lev-2).val(), lev-1);//조직트리 해당 조직으로 선택								}else{				$.fn.cmtree.treeRelComboboxMake($this.val(),'', lev);//하위 셀렉트박스 생성								$.fn.cmtree.selTreeParentAll($this.val(), lev);//조직트리 해당 조직으로 선택							}				}else{			$.fn.cmtree.treeRelComboboxMake($this.val(),'', lev);//하위 셀렉트박스 생성						$.fn.cmtree.selTreeParentAll($this.val(), lev);//조직트리 해당 조직으로 선택					}				}		var opt_i = 0;	var opts_str = "";	// 현재 선택된 마지막 분류코드를 불러온다	var selmatrtpcd = "";	var selmatrtpcd_lev = "";	var selmatrtpcd_lev4 = "";	if($("select[name='org_option']").eq($("select[name='org_option']").length-1).val() == ""){		selmatrtpcd = $("select[name='org_option']").eq($("select[name='org_option']").length-2).val();	}else{		selmatrtpcd = $("select[name='org_option']").eq($("select[name='org_option']").length-1).val();	}		// 그리드 조회	if(gridreloadyn!="N"){		refreshGrid(false); //조회	}}// 입력항목 초기화//TODO : insertfInitfunction insertfInit(){	$("#iorg_nm").val("");// 조직명	$("#iorg_sort_no").val("");// 조직순번	$("#iuse_st_ymd").val("");// 조직사용시작일	$("#iuse_end_ymd").val("");// 조직사용종료일	$("#iorg_desc").val("");// 조직비고	//$("#iorg_area_cd > option[value=]").attr("selected", true);//권역	//$("#ibrnch_org_cd > option[value=]").attr("selected", true);//권역	$("#iorg_cd").val("");// 조직코드	$("#iorg_seqno").val("");// 조직일련번호	//$("#iorg_rcv_excpt_cd > option[value=]").attr("selected", true);//조직인수제외여부		$("#imorg_cd").val("");// 이동될 상위 조직코드	$("#ihorg_sort_no").val("");// 원조직순번			//$("#iorg_ty_cd > option[value=]").attr("selected", true);//조직유형	$("#iorg_ty_cd").val("");		$("#spbtn_del").hide();	$("#btn_save").show();	$("#spbtn_move").hide();	$("#spbtn_init").hide();		}//TODO : chgTabfunction chgTab(tabnum){	if(tabnum==0){		$("#spbtn_search").show();		$("#search_only").show();		$("#save_only1").hide();		$("#save_only2").hide();		$("#save_only3").hide();		$("#spbtn_save").hide();		$("#spbtn_del").hide();		$("#spbtn_move").hide();		$("#spbtn_init").hide();					}else if(tabnum==1){		$("#spbtn_search").hide();		$("#search_only").hide();		$("#save_only1").show();		$("#save_only2").show();		$("#save_only3").show();		$("#spbtn_save").show();		if(!isEmpty($("#iorg_seqno").val()) ){			$("#spbtn_del").show();			$("#spbtn_move").show();			$("#spbtn_init").show();					}else{			$("#spbtn_del").hide();			$("#spbtn_move").hide();			$("#spbtn_init").hide();					}			}	$(".tab_menu li").removeClass("selected");	$(".tab_menu li").eq(tabnum).addClass("selected");		}//TODO : $(document).ready(function() {$(document).ready(function() {	//alert(jQuery("#jqGrid").jqGrid('getGridParam','reccount'));});</script><form name="listfrm" id="listfrm" method="post" onSubmit='return false;Go_search();' >        <input type="hidden" name="scode" id="scode" value="<%=scode%>" title="사이트코드" /><input type="hidden" name="pcode" id="pcode" value="<%=pcode%>" title="페이지코드"  /><input type="hidden" name="pstate" id="pstate" value="<%=pstate%>" title="페이지상태"  /><input type="hidden" name="curr_page" id="curr_page" value="<%=curr_page%>" title="현재페이지번호"  /><input type="hidden" name="show_rows" id="show_rows" value="<%=show_rows%>" title="현재페이지당데이터수"  /><input type="hidden" name="sidx" value="" title="선택된인덱스" /><input type="hidden" name="cod_used" id="cod_used" value="" /><input type="hidden" name="cod_del" id="cod_del" value="" /><input type="hidden" name="iorg_seqno" id="iorg_seqno" value="" /><input type="hidden" name="ihorg_sort_no" id="ihorg_sort_no" value="" /><input type="hidden" name="imorg_cd" id="imorg_cd" value="" /><input type="hidden" name="iuppo_org_cd" id="iuppo_org_cd" value="" /><input type="hidden" name="delkey" id="delkey" value="" />                              <!-- 복합영역 --><div class="sectionBlue"> 	<!-- 트리 영역 -->	<div class="treeArea" id="treeArea">		<p class="tit round fL"><a href="#" onclick="cmtreechkCall()">조직도</a></p>		<div class="treeMenu round fL mR10" id="treeMenu">			<ul id="cmtree_data">			</ul>		</div>									<!-- 조직선택팝업 예제 추후 삭제 -->			<table cellspacing="0" cellpadding="0" class="defaultTable02" style="display:none;">				<colgroup>					<col width="100%" />				</colgroup>				<tr>					<td>										<span >조직선택팝업예제	</span>						</td>				</tr>				<tr>					<td>											<span><input type="text" id="s_org_cd"  name="s_org_cd" maxlength="100" title="" style="width:150px;" readonly="readonly" value="" />					<span class="btnIc_search" id="btn_org_search" ><a href="#"></a></span>						</span>					</td>				</tr>									<tr>					<td>											<span><input type="text" id="s_org_nm"  name="s_org_nm" maxlength="100" title="" style="width:150px;" readonly="readonly" value="" />		        	<span class="btnIc_search" id="btn_orgsawon_search" ><a href="#"></a></span>					</span>					</td>				</tr>			</table>			<!-- 조직선택팝업 예제 추후 삭제 -->							</div>	<!-- 트리 영역 // -->                                      	<!-- start of search -->	<div >		<!-- tab -->		<ul class="tab_menu">			<li class="selected"><a href="#none" onclick="chgTab(0)" id="tab_link0">검색</a></li>			<li><a href="#none" onclick="chgTab(1)" id="tab_link1">저장</a></li>		</ul>		<!-- tab //-->		</div>	<div class="searchArea">			<table class="tbl_search">			<colgroup>			<col width="50" />			<col width="120" />			<col width="50" />			<col width="120" />			<col width="50" />			<col width="*" />			</colgroup>			<tr>				<th scope="row">조직선택</th>				<td colspan="5" id="org_select_group">					<select name="org_option" id="org_option" onchange="optionGroup($(this), 1,'N','')">						<option value="">--선택--</option>					</select>							</td>			</tr>			<tr id="search_only">				<th scope="row">조직명</th>				<td>					<input type="text" name="sorg_nm" title="조직명 입력"/>				</td>				<th scope="row">기준일자</th>				<td >					<input type="text" name="base_ymd" id="base_ymd" class="fL" value="<%=curDate.substring(0,4)+"-"+curDate.substring(4,6)+"-"+curDate.substring(6,8)%>" size="12" onblur="is_valid_date(this);" onkeyup="maskCal();" onfocus="this.select();" title="기준일자 입력" readonly="readonly" />					<span class="btnIc_calendar" style="vertical-align:middle;"><a href="#" onclick="Calendar_D(document.getElementsByName('base_ymd')[0]);return false;"></a></span>				</td>				<td colspan="2">					<p class="fR">	     			<span class="btn_pack large" id="spbtn_search"><a href="#" id="btn_search">검색</a></span>	      			</p>      							</td>										</tr>	        <tr id="save_only1">				<th scope="row" class="essential">조직명</th>	          	<td>	          		<input name="iorg_nm" id="iorg_nm" type="text" title="조직명 입력" class="fl in" maxlength="50" value="" />	            </td>	            	          	<th scope="row" class="essential">조직순번</th>	          	<td><input name="iorg_sort_no" id="iorg_sort_no" type="text"  title="조직순번 입력" maxlength="4" value="" class="fl in" style="ime-mode: disabled;" onKeyDown="return onlyNum();" /></td>	          		          	<th scope="row" class="essential">조직코드</th>	          	<td><input type="text" name="iorg_cd" id="iorg_cd" value="" maxlength="10" readonly title="조직코드" />	          	</td>	        </tr>	        <tr id="save_only2">				<th scope="row" class="essential">조직 유형</th>	          	<td >					<select name="iorg_ty_cd" id="iorg_ty_cd">						<option value="">--선택--</option>						<%=(String)rtn_Map.get("storg_ty_cd")%>					</select>	            </td>				<th scope="row">조직비고</th>	          	<td colspan="3">	          		<textarea name="iorg_desc" id="iorg_desc" maxlength="1000" class="w_90" ></textarea>	            </td>                   		        </tr> 	        	        <tr id="save_only3">	          	<th scope="row">사용기간</th>	          	<td colspan="3">		            <input type="text" name="iuse_st_ymd" id="iuse_st_ymd" value="<%=curDate.substring(0,4)+"-"+curDate.substring(4,6)+"-"+curDate.substring(6,8)%>" onblur="is_valid_date(this);" onkeyup="maskCal();" onfocus="this.select();" title="사용시작일 입력"  /> 		            <span class="btnIc_calendar"><a href="#" onclick="Calendar_D(document.getElementsByName('iuse_st_ymd')[0]);return false;"></a></span>		            <span class="clear">		            <b>~</b>		            </span>		            <input type="text" name="iuse_end_ymd" id="iuse_end_ymd" onblur="is_valid_date(this);" onkeyup="maskCal();" onfocus="this.select();" title="사용종료일 입력" />		            <span class="btnIc_calendar"><a href="#" onclick="Calendar_D(document.getElementsByName('iuse_end_ymd')[0]);return false;" ></a></span>		            	          	</td> 	          	         					<td colspan="2">					<p class="fR">	      			<span class="btn_pack largeO" id="spbtn_save" style="display:none;"><a href="#" id="btn_save">저장</a></span>	      			<span class="btn_pack largeO" id="spbtn_del" style="display:none;"><a href="#none" id="btn_del" >삭제</a></span>	      			<span class="btn_pack largeO" id="spbtn_move" style="display:none;"><a href="#none" id="btn_move" >이동</a></span>	      			<!-- <span class="btn_pack large" id="spbtn_move" style="display:none;"><a href="#" id="btn_move" onclick="moveSelected()">확정</a></span> -->	      			<span class="btn_pack largeO" id="spbtn_init" style="display:none;"><a href="#none" id="btn_init" onclick="insertfInit()">초기화</a></span>	      			</p>      							</td> 	          	         		        </tr>								</table>			</div>			<!-- end of search -->	        <!-- 첫번째 목록영역 -->	        <div class="section mB5">	          <p class="fR">		           <span class="btn_pack medium icon" id="btn_excel" ><span class="excel"></span><a href="#none" >화면출력</a></span>		           <span class="btn_pack medium icon" id="btn_excelAll" ><span class="excel"></span><a href="#none" >전체출력</a></span>		      </p>	        </div>	        <!-- 첫번째 목록영역 -->  	        <div class="section" id="jqGridDiv">			    <table id='jqGrid' minuswh="200" fixwidth="N"></table>			    <!-- <div id="jqGridPager" style="text-align:center;"></div> -->        	        </div> 	</div>	</form><!-- <textarea id="tree_str" style="width:100%;height:100px;"></textarea> -->					<!--내용끝-->