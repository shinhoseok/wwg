<%--/*=================================================================================*//* 시스템            : 시스템 SYSTEM/* 프로그램 아이디   : /WEB-INF/jsp/ji/cm/oam/jicm_oam_010_i2/* 프로그램 이름     : jicm_oam_010_i2    /* 소스파일 이름     : jicm_oam_010_i2.jsp/* 설명              : SYSTEM 조직관리/* 버전              : 1.0.0/* 최초 작성자       : 이금용/* 최초 작성일자     : 2014-02-05/* 최근 수정자       : 이금용/* 최근 수정일시     : 2014-02-05/* 최종 수정내용     : 최초작성/*=================================================================================*/--%><%@page pageEncoding="utf-8"%>// 조직트리var cmtreeval_cm_oam_<%=pcode%> = new Array();var create_form_popup_width_cm_oam_<%=pcode%> = 0;var create_form_popup_height_cm_oam_<%=pcode%> = 0;var multi_yn_cm_oam_<%=pcode%> = "";var check_yn_cm_oam_<%=pcode%> = "";var returnId_cm_oam_<%=pcode%> = "";var sorg_cd_cm_oam_<%=pcode%> = "";//TODO : create_form_close_cm_oam_<%=pcode%> //등록 ,수정창 닫기function create_form_close_cm_oam_<%=pcode%>(){	$("#create_form_popup_cm_oam_<%=pcode%>").hide();	create_form_init_cm_oam_<%=pcode%>();	CmclospageDisable();}function btn_sawon_search2_cm_oam_<%=pcode%>(multi_yn, check_yn,returnId,sorg_cd) {	CmopenpageDisable();	var i = 0;	if(multi_yn==undefined || multi_yn==""){		multi_yn_cm_oam_<%=pcode%> = "N";	}else{		multi_yn_cm_oam_<%=pcode%> = multi_yn;	}		if(check_yn==undefined || check_yn==""){		check_yn_cm_oam_<%=pcode%> = "Y";	}else{		check_yn_cm_oam_<%=pcode%> = check_yn;	}		if(returnId==undefined || returnId==""){		returnId_cm_oam_<%=pcode%> = "";	}else{		returnId_cm_oam_<%=pcode%> = returnId;	}		if(sorg_cd==undefined || sorg_cd==""){		sorg_cd_cm_oam_<%=pcode%> = "";	}else{		sorg_cd_cm_oam_<%=pcode%> = sorg_cd;	}					var sc_pos = 0;	var pop_div_html = "";	var pop_contents_html = "";		pop_div_html = pop_div_html+'<div id="create_form_popup_cm_oam_<%=pcode%>" class="ly_pop" style="position:absolute;top:0%;left:0%;z-index:9000;display:none;">';	pop_div_html = pop_div_html+'	<h1 id="ly_pop_title_cm_oam_<%=pcode%>"><span>&#8226;</span>팝업</h1><span class="close" id="create_form_popup_close_cm_oam_<%=pcode%>" onclick="create_form_close_cm_oam_<%=pcode%>();return false;"><a href="#" onclick="return false;" ></a></span>';	pop_div_html = pop_div_html+'	<div id="create_form_popup_contents_cm_oam_<%=pcode%>" style="padding:5px;"></div>';	pop_div_html = pop_div_html+'	<br />';	pop_div_html = pop_div_html+'	<div class="section aC mT5 mB5" style="clear:both;" id="popup_btn_area_cm_oam_<%=pcode%>">';	pop_div_html = pop_div_html+'		<span class="btn_pack large2" id="create_form_popup_btn_confirm_cm_oam_<%=pcode%>" onclick="btn_sawon_confirm_cm_oam_<%=pcode%>();return false;">확인</span>';	pop_div_html = pop_div_html+'		<span class="btn_pack large2" id="create_form_popup_btn_close_cm_oam_<%=pcode%>" onclick="create_form_close_cm_oam_<%=pcode%>();return false;">닫 기</span>';	pop_div_html = pop_div_html+'	</div>';		pop_div_html = pop_div_html+'	<br />';	pop_div_html = pop_div_html+'</div>';			// 팝업 객체를 body 에 append한다		$("body").append(pop_div_html);		//console.log("jicm_oam_010_i2===>1111");	$("#create_form_popup_contents_cm_oam_<%=pcode%>").html("");	// 팝업창 내용이 엄으면 만들어 준다	if($("#create_form_popup_contents_cm_oam_<%=pcode%>").html()==""){		pop_contents_html = "";		pop_contents_html = pop_contents_html + '<div class="search_box" style="margin-bottom:10px;">';		pop_contents_html = pop_contents_html + '	<div class="seach_cell">';		pop_contents_html = pop_contents_html + '		<label for="">구분 :</label>';		pop_contents_html = pop_contents_html + '		<select id="org_sty_cm_oam_<%=pcode%>" name="org_sty_cm_oam_<%=pcode%>" style="width:100px;" title="조직구분 선택">';		pop_contents_html = pop_contents_html + '          <option value="">---- 전체 ----</option>';		pop_contents_html = pop_contents_html + '          <option value="nm">조직명</option>';		pop_contents_html = pop_contents_html + '          <option value="cd">조직코드</option>';		pop_contents_html = pop_contents_html + '          <option value="user_nm">사원명</option>';		pop_contents_html = pop_contents_html + '        </select>';		pop_contents_html = pop_contents_html + '	</div>';					pop_contents_html = pop_contents_html + '	<div class="seach_cell">';		pop_contents_html = pop_contents_html + '		<label for="">검색어 :</label>';		pop_contents_html = pop_contents_html + '		<input type="text" id="org_stext_cm_oam_<%=pcode%>"  name="org_stext_cm_oam_<%=pcode%>" maxlength="100" title="" class="input_type01 w_normal seach_input" style="width:100px;"  value="" onkeydown="org_stext_keydown_cm_oam_<%=pcode%>();" />';							pop_contents_html = pop_contents_html + '	</div>';				pop_contents_html = pop_contents_html + '	<div class="seach_cell">';		pop_contents_html = pop_contents_html + '		<label for="">하위조직포함 :</label>';		pop_contents_html = pop_contents_html + '		<select name="subinYn_cm_oam_<%=pcode%>" id="subinYn_cm_oam_<%=pcode%>" title="하위조직 포함 여부 선택">';			pop_contents_html = pop_contents_html + '		<option value="Y">포함</option>';			pop_contents_html = pop_contents_html + '		<option value="N" selected>미포함</option>';			pop_contents_html = pop_contents_html + '		</select>	';							pop_contents_html = pop_contents_html + '	</div>';					        			//pop_contents_html = pop_contents_html + '	<div class="seach_cell">';		//pop_contents_html = pop_contents_html + '		<span><input name="chk_org_search_cm_oam_<%=pcode %>" id="chk_org_search_cm_oam_<%=pcode %>" value="Y" type="checkbox" onclick="fn_check_charge_cm_oam_<%=pcode %>();return false;"> 토건담당</span>';		//pop_contents_html = pop_contents_html + '	</div>';					pop_contents_html = pop_contents_html + '	<div class="seach_cell" style="float:right;vertical-align:bottom;">';		pop_contents_html = pop_contents_html + '		<span class="btn_pack large2 vM" id="btn_org_search_cm_oam_<%=pcode%>" onclick="refreshOrgGrid_cm_oam_<%=pcode%>(true);return false;">검색</span>';		pop_contents_html = pop_contents_html + '	</div>';		pop_contents_html = pop_contents_html + '</div>';	        //console.log("111");	    pop_contents_html = pop_contents_html+'<span style="width:220px;float:left;margin-top:0px;">';	    pop_contents_html = pop_contents_html+'	<div class="treeArea" id="treeArea">';	    pop_contents_html = pop_contents_html+'		<p class="tit round fL"><a href="#" onclick="return false;">조직</a>';	    pop_contents_html = pop_contents_html+'		<div class="treeMenu round fL mR10" id="treeMenu">';	    pop_contents_html = pop_contents_html+'			<ul id="cmtree_data_org_cm_oam_<%=pcode%>"></ul>';	    pop_contents_html = pop_contents_html+'		</div>';	    pop_contents_html = pop_contents_html+'	</div>';	    pop_contents_html = pop_contents_html+'</span>';		pop_contents_html = pop_contents_html+'<span style="width:590px;float:left;margin-top:0px;margin-left:20px;"><div class="board_title"><span>&#8226;</span>사원리스트</div><table id="jqGridSawonSel_cm_oam_<%=pcode%>"  fixwidth="N" autoResizeYn="N" ></table></span>';		 //console.log("222");		pop_contents_html = pop_contents_html+'<span id="multiDiv_cm_oam_<%=pcode%>" style="width:590px;float:left;margin-top:5px;margin-bottom:5px;margin-left:20px;display:none;">';	    pop_contents_html = pop_contents_html+'	<span class="board_title" style="width:40%;">사원선택</span>';	    pop_contents_html = pop_contents_html+'	<span style="float:right;width:56%;float:right;text-align:right;">';	    pop_contents_html = pop_contents_html+'		<span class="btn_pack medium icon" id="btn_add_cm_oam_<%=pcode%>" align="right"><span class="add"></span><a href="#" onclick="return false;" >추가</a></span>';	    pop_contents_html = pop_contents_html+'		<span class="btn_pack medium icon" id="btn_remove_cm_oam_<%=pcode%>"><span class="delete"></span><a href="#" onclick="return false;" >삭제</a></span>';		pop_contents_html = pop_contents_html+'	</span>';		//console.log("333");		pop_contents_html = pop_contents_html+'	<span style="float:left;"><table id="jqGridSawonSel2_cm_oam_<%=pcode%>"  fixwidth="N" autoResizeYn="N" ></table></span>';		pop_contents_html = pop_contents_html+'</span>';		//console.log("444");				//$("#create_form_popup_cm_oam_<%=pcode%>").width(600);		//$("#create_form_popup_cm_oam_<%=pcode%>").height(600);		// 팝업창 타이틀		$("#ly_pop_title_cm_oam_<%=pcode%>").html("<span>&#8226;</span>사원선택");		//console.log(pop_contents_html);		$("#create_form_popup_contents_cm_oam_<%=pcode%>").html(pop_contents_html);			//$("#popup_btn_area").prepend("<span class='btn_1' id='create_form_popup_btn_confirm_cm_oam_<%=pcode%>' onclick='btn_sawon_confirm_cm_oam_<%=pcode%>();return false;'>확인</span>");		//alert('1111');		//console.log("jicm_oam_010_i2===>22222");		$.fn.cmtree({			 id			: '#cmtree_data_org_cm_oam_<%=pcode%>' 			 ,treeAreaId : "#treeArea"			 ,treeMenuId : "#treeMenu"			 ,treeHeight : (436)+"px"			 ,treeWidth  : (220)+"px"			 ,treemHeight : (436-32)+"px"			 ,treemWidth : (220-34)+"px"				 ,checkBoxYn: false			 ,treeArr   : cmtreeval_cm_oam_<%=pcode%>			 ,setAllYn : false			 ,onClickTitlefn: "treeClickTitleSawon_cm_oam_<%=pcode%>"			 ,treeRelComboId : ""			 ,treeRelComboboxId : ""			 ,treeImgPath : "<%=img_url%>"		});		//console.log("jicm_oam_010_i2===>3333");						//사원 리스트		var cols_SawonSel_cm_oam_<%=pcode%> =[{label:'번호'     ,index:'row_seqno'     		,name:'row_seqno'  		,align:'center' 		,width : '30'		,hidden:true, sortable : true }		    ,{label:'사원일련번호' 	 	,index:'user_seqno'    	  	,name:'user_seqno' 		,align:'center' 		,width : '0'		,hidden:true, sortable : true }		    ,{label:'사원ID'		 	,index:'user_id'     		,name:'user_id'    		,align:'center' 		,width : '80'		,hidden:false, editable:false, sortable : true}		    ,{label:'성명'			,index:'user_nm'     		,name:'user_nm'    		,align:'center' 		,width : '80'		,hidden:false, editable:false, sortable : true}		    ,{label:'직급'       	 	,index:'grd_cd'				,name:'grd_cd'     		,align:'center'  		,width : '80'  		,hidden:true, sortable:false }		    ,{label:'직급'       	 	,index:'grd_nm'				,name:'grd_nm'     		,align:'center'  		,width : '80'  		,hidden:false, sortable:false }		    ,{label:'사업소' 	 		,index:'bs_off_cd'       	,name:'bs_off_cd'  		,align:'center' 		,width : '100'		,hidden:true, sortable : true , formatter:fm_bs_off_cd_<%=pcode%>}		    ,{label:'사업소' 	 		,index:'bs_off_nm'       	,name:'bs_off_nm'  		,align:'center' 		,width : '120'		,hidden:false, sortable : true, formatter:fm_bs_off_nm_<%=pcode%>}				    ,{label:'부서코드'			,index:'org_cd'      		,name:'org_cd'    		,align:'center' 		,width : '100'		,hidden:true, editable:false, sortable : true}		    ,{label:'부서명'			,index:'org_nm'      		,name:'org_nm'    		,align:'center' 		,width : '120'		,hidden:false, editable:false, sortable : true}		    		    ,{label:'부서유형'			,index:'org_ty_cd'      	,name:'org_ty_cd'   	,align:'center' 		,width : '80'		,hidden:true, editable:false, sortable : true}		    ,{label:'상위부서'			,index:'uppo_org_cd'      	,name:'uppo_org_cd' 	,align:'center' 		,width : '80'		,hidden:true, editable:false, sortable : true}		    ,{label:'부서유형'			,index:'org_ty_cd_nm'      	,name:'org_ty_cd_nm'	,align:'center' 		,width : '80'		,hidden:true, editable:false, sortable : true}		    ,{label:'부서코드전체'		,index:'org_cs'      		,name:'org_cs'			,align:'center' 		,width : '80'		,hidden:true, editable:false, sortable : true}		    ,{label:'부서명전체'		,index:'org_nms'      		,name:'org_nms'			,align:'center' 		,width : '80'		,hidden:true, editable:false, sortable : true}		    ,{label:'email'			,index:'email'      		,name:'email'			,align:'center' 		,width : '80'		,hidden:true, editable:false, sortable : true}		    ,{label:'핸드폰'			,index:'moblphon'      		,name:'email'			,align:'center' 		,width : '80'		,hidden:true, editable:false, sortable : true}		    ,{label:'내선'			,index:'naesun'      		,name:'naesun'			,align:'center' 		,width : '80'		,hidden:true, editable:false, sortable : true}		];										//init grid		var grid_SawonSel_cm_oam_<%=pcode%> = com.grid.init({			 id			: '#jqGridSawonSel_cm_oam_<%=pcode%>' 			,height		: ((multi_yn_cm_oam_<%=pcode%>=="Y")?140:350)			,rowNum		: 1000			,rowList	: 1			,shrinkToFit: false // 컬럼이 그리드 width에 맞춰 자동으로 맞춰질지 여부			,autowidth : true			,multiselect: true			,viewrecords: true			,rownumbers  : true 	//Row number 표시			,recordtext : "{2}건"			,gridComplete: function(){				mergeCellcomplet($(this));							}			,ondblClickRow: function(id) { // row를 선택했을때 액션.								var ret = $("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid("getRowData",id); // ret는 선택한 row 값을 쥐고있는 객체다.				/*var gridArr = new Array();				gridArr[0] = ret;			    				opener.(gridArr);				self.close(); 				*/			}			,custom : { //custom				 cols : cols_SawonSel_cm_oam_<%=pcode%> //컬럼정보 - 필수!				,navButton : {					excel : {						exportName	: $('.con_title>h3').text().trim() //엑셀다운로드시 사용할 파일명					}				}			}		});				//init grid		var grid_SawonSel2_cm_oam_<%=pcode%> = com.grid.init({			 id			: '#jqGridSawonSel2_cm_oam_<%=pcode%>' 			,height		: 120			,rowNum		: -1			,scroll		: 1			,shrinkToFit: false // 컬럼이 그리드 width에 맞춰 자동으로 맞춰질지 여부			,autowidth : true			,multiselect: true			,viewrecords: false			,rownumbers  : true 	//Row number 표시			,gridComplete: function(){				mergeCellcomplet($(this));							}			,ondblClickRow: function(id) { // row를 선택했을때 액션.								var ret = $("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid("getRowData",id); // ret는 선택한 row 값을 쥐고있는 객체다.				/*var gridArr = new Array();				gridArr[0] = ret;			    				opener.(gridArr);				self.close(); 				*/			}			,custom : { //custom				 cols : cols_SawonSel_cm_oam_<%=pcode%> //컬럼정보 - 필수!				,navButton : {					excel : {						exportName	: $('.con_title>h3').text().trim() //엑셀다운로드시 사용할 파일명					}				}			}		});							//console.log("jicm_oam_010_i2===>4444");								create_form_popup_width_cm_oam_<%=pcode%> = 	$("#create_form_popup_cm_oam_<%=pcode%>").width();		create_form_popup_height_cm_oam_<%=pcode%> =  $("#create_form_popup_cm_oam_<%=pcode%>").height();	}	$("#create_form_popup_cm_oam_<%=pcode%>").width(create_form_popup_width_cm_oam_<%=pcode%>);	$("#create_form_popup_cm_oam_<%=pcode%>").height(create_form_popup_height_cm_oam_<%=pcode%>);	//grid_win_resizeAuto();	//alert($("#create_form_popup_cm_oam_<%=pcode%>").width()+"---"+$("#create_form_popup_cm_oam_<%=pcode%>").height());		// 수정, 등록창의 위치를 잡는다	$("#create_form_popup_cm_oam_<%=pcode%>").css("left",( (($(document).width() - $("#create_form_popup_cm_oam_<%=pcode%>").width()) / 2) + $(document).scrollLeft() )+"px");	$("#create_form_popup_cm_oam_<%=pcode%>").css("top", ((($(document).height() - $("#create_form_popup_cm_oam_<%=pcode%>").height()) / 5) + $(document).scrollTop() )+"px");		//alert($("#org_text_div").scrollTop()+"==>"+sc_pos);		jQuery("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid("setGridWidth",580);	if(multi_yn_cm_oam_<%=pcode%>!="Y"){// 한건 선택일 경우		$('#multiDiv_cm_oam_<%=pcode%>').hide();	}else{// 다중 선택일 경우 		$('#multiDiv_cm_oam_<%=pcode%>').fadeIn(300);		//grid_win_resizeAuto();		jQuery("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid("setGridWidth",580);	}	    $("#create_form_popup_cm_oam_<%=pcode%>").draggable({ opacity:"0.3",cancel:"#create_form_popup_contents_cm_oam_<%=pcode%>" }); // 끄는 동안만 불투명도 주기        $("body").droppable({        accept: "#create_form_popup_cm_oam_<%=pcode%>",    // 드롭시킬 대상 요소        drop: function(event, ui) {        	$("#create_form_popup_cm_oam_<%=pcode%>").css({ opacity:"1.0" });        }    });	    //console.log("jicm_oam_010_i2===>5555");		//그리드 삽입 	$("#btn_add_cm_oam_<%=pcode%>").click( function(e) {				//추가될 그리드 마지막행 가져오기		var ids = jQuery("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid('getDataIDs');		var addCnt  = 0;				for(var i=0;i < ids.length;i++) {			addCnt = ids[i];		}				var ids = jQuery("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getGridParam', 'selarrrow');	    if(ids.length==0){	    	alert('추가할 항목을 선택하세요.');	    	return;	    }	    	  //추가할 그리드 항목	    for(var i=0;i<ids.length;i++){	    	    	var row_val = $("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]);	    		    	/*	    	var user_seqno = $("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getCell', ids[i],'user_seqno');//사원일련번호	    	var user_id = $("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getCell', ids[i],'user_id');//직원아이디	    	var user_nm = $("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getCell', ids[i],'user_nm');//직원명	    	var now_jobgrd_cd = $("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getCell', ids[i],'now_jobgrd_cd');//직급코드	    	var now_jobgrd_cd_nm = $("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getCell', ids[i],'now_jobgrd_cd_nm');//직급명	    	var emp_top_org_cd = $("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getCell', ids[i],'emp_top_org_cd');//최상위조직명	    	var emp_top_org_nm = $("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getCell', ids[i],'emp_top_org_nm');//최상위조직명	    	var org_cd = $("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getCell', ids[i],'org_cd');//조직코드	    	var org_nm = $("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getCell', ids[i],'org_nm');//조직명	    	var org_ty_cd = $("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getCell', ids[i],'org_ty_cd');//조직유형코드	    	var uppo_org_cd = $("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getCell', ids[i],'uppo_org_cd');//상위조직코드	    	var org_ty_cd_nm = $("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getCell', ids[i],'org_ty_cd_nm');//조직유형명	    	*/				    	// 선택한 사용자가 등록되어있는지 확인한다	    	var ids2 = jQuery("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid('getDataIDs');	    	var chk_j =0;			var dup_chk = 0;	    	for ( chk_j=0; chk_j<ids2.length; chk_j++ ) {	    		//alert(chk_val0);	    		//alert($("#jqGridAprv").jqGrid('getCell', ids[chk_j], 'aprv_emp_id'));	    		if(row_val.user_id!=""){	    			if(row_val.user_id == $("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid('getCell', ids2[chk_j], 'user_id')			    		    			){	    		    				dup_chk++;	    		    			}	    		}	    	}	    		    	if(dup_chk == 0){				addCnt = parseInt(addCnt)+1;		    	//console.log(row_val);				var targetData = "";					targetData = { row_seqno 	: ''								  ,user_seqno   : row_val.user_seqno					          	  ,user_id     	: row_val.user_id					          	  ,user_nm     	: row_val.user_nm					          	  ,grd_cd     	: row_val.grd_cd					          	  ,grd_nm  		: row_val.grd_nm					          	  ,bs_off_cd    : row_val.bs_off_cd					          	  ,bs_off_nm    : row_val.bs_off_nm					          	  ,org_cd      	: row_val.org_cd					          	  ,org_nm      	: row_val.org_nm					          	  ,org_ty_cd    : row_val.org_ty_cd							  	  ,uppo_org_cd  : row_val.uppo_org_cd							  	  ,org_ty_cd_nm : row_val.org_ty_cd_nm							  	  ,org_cs      	: row_val.org_cs							  	  ,org_nms      : row_val.org_nms							}									jQuery("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid('addRowData',addCnt,targetData);	    			    	}						}//for			});		//그리드 삭제	$("#btn_remove_cm_oam_<%=pcode%>").click(function(e){			  	var value = "";	  	var ids = jQuery("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid('getGridParam', 'selarrrow');	    if(ids.length==0){	    	alert('삭제할 항목을 선택하세요');	    	return;	    }	    	    for( var i=ids.length; i>0; i-- ){	       $("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid('delRowData', ids[i-1])	    }		  	});			refreshOrgTree_cm_oam_<%=pcode%>();//트리조회		// 조직코드가 있을경우 해당조직을 선택한다	if(sorg_cd_cm_oam_<%=pcode%>!=""){		treeClickTitleSawon_cm_oam_<%=pcode%>($.fn.cmtree.rtnTreeArr(sorg_cd_cm_oam_<%=pcode%>));	}				$("#create_form_popup_cm_oam_<%=pcode%>").show(500);		}function create_form_init_cm_oam_<%=pcode%>(){	$("form[name=pagego]").find("#seltreeorgcd").remove();	$("form[name=pagego]").find("#sty").remove();	$("form[name=pagego]").find("#stext").remove();	//$("#popup_btn_area").find("#create_form_popup_btn_confirm_cm_oam_<%=pcode%>").remove();	$('#create_form_popup_cm_oam_<%=pcode %>').remove();}//확정버튼function btn_sawon_confirm_cm_oam_<%=pcode%>(){		var gridArr = new Array();	gridArr.push(new Array());	gridArr.push(new Array());	gridArr.push(new Array());		gridArr.push(new Array());		gridArr.push(new Array());	gridArr.push(new Array());	gridArr.push(new Array());	gridArr.push(new Array());	gridArr.push(new Array());	gridArr.push(new Array());	gridArr.push(new Array());	gridArr.push(new Array());	gridArr.push(new Array());	gridArr.push(new Array());	gridArr.push(new Array());	gridArr.push(new Array());	gridArr.push(new Array());    	if(multi_yn_cm_oam_<%=pcode%>!="Y"){// 한건 선택일 경우		var ids = jQuery('#jqGridSawonSel_cm_oam_<%=pcode%>').jqGrid('getGridParam', 'selarrrow');	    if(ids.length==0){	    	alert('항목을 선택하세요.');	    	return;	    }	    	    if(ids.length>1){	    	alert('1건만 선택하세요.');	    	return;	    }	    	    for(var i=0;i<ids.length;i++){							gridArr[0].push($("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).user_id);//직원아이디				gridArr[1].push($("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).user_nm);//직원명				gridArr[2].push($("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).bs_off_nm);//사업소조직명				gridArr[3].push($("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).org_nm);//조직명				gridArr[4].push($("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).org_cd);//조직코드				gridArr[5].push(returnId_cm_oam_<%=pcode%>);				gridArr[6].push($("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).org_ty_cd);//조직유형코드				gridArr[7].push($("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).org_ty_cd_nm);//조직유형명				gridArr[8].push($("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).uppo_org_cd);//상위조직코드				gridArr[9].push($("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).bs_off_cd);//사업소 조직코드				gridArr[10].push($("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).grd_cd);//직급코드				gridArr[11].push($("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).grd_nm);//직급명				gridArr[12].push($("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).org_cs);//전체부서코드				gridArr[13].push($("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).org_nms);//전체부서명				gridArr[14].push($("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).email);//이메일				gridArr[15].push($("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).moblphon);//핸드폰				gridArr[16].push($("#jqGridSawonSel_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).naesun);//내선								   }	        }else{			var ids = jQuery("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid('getGridParam', 'selarrrow');		    if(ids.length==0){		    	alert('추가할 항목을 선택하세요.');		    	return;		    }		    		    for(var i=0;i<ids.length;i++){				gridArr[0].push($("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).user_id);//직원아이디				gridArr[1].push($("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).user_nm);//직원명				gridArr[2].push($("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).bs_off_nm);//사업소조직명				gridArr[3].push($("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).org_nm);//조직명				gridArr[4].push($("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).org_cd);//조직코드				gridArr[5].push(returnId_cm_oam_<%=pcode%>);				gridArr[6].push($("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).org_ty_cd);//조직유형코드				gridArr[7].push($("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).org_ty_cd_nm);//조직유형명				gridArr[8].push($("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).uppo_org_cd);//상위조직코드				gridArr[9].push($("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).bs_off_cd);//사업소 조직코드				gridArr[10].push($("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).grd_cd);//직급코드				gridArr[11].push($("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).grd_nm);//직급명				gridArr[12].push($("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).org_cs);//전체부서코드				gridArr[13].push($("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).org_nms);//전체부서명				gridArr[14].push($("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).email);//이메일				gridArr[15].push($("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).moblphon);//핸드폰				gridArr[16].push($("#jqGridSawonSel2_cm_oam_<%=pcode%>").jqGrid('getRowData', ids[i]).naesun);//내선						   }        }    	    	    create_form_close_cm_oam_<%=pcode%> ();	    setOrgSawonAdd_cm_oam_<%=pcode%>(gridArr);    }//조회 : 트리조회function refreshOrgTree_cm_oam_<%=pcode%>(){	//alert('refreshTree');	//$("form[name=pagego]").append("<input type='hidden' name='tree_group_cd' id='tree_group_cd' value='M10017'/>");	$("form[name=pagego]").find("#scode").val("000008");	$("form[name=pagego]").find("#pcode").val("000038");	//$("form[name=pagego]").find("#pstate").val("X3");	$("form[name=pagego]").find("#pstate").val("X1");	var params =  $("form[name=pagego]").serialize();	//var params = jQuery('form').serialize();	//var params = com.frm.getParamJSON(document.listfrm);	//alert(params);	$.fn.cmtree.reload('#cmtree_data_org_cm_oam_<%=pcode%>','<c:url value='/cmsajax.do'/>',params);	//$("form[name=pagego]").find("#tree_group_cd").remove();	$("form[name=pagego]").find("#pstate").val("L");	}//조회 : 토건담당자조회function fn_check_charge_cm_oam_<%=pcode %>() {	if(!$("#chk_org_search_cm_oam_<%=pcode %>").is(":checked")) return;				$("form[name=pagego]").find("#scode").val("000008");	$("form[name=pagego]").find("#pcode").val("000038");	var params = com.frm.getParamJSON($("form[name=pagego]"));	params.pstate = 'PX3';			com.grid.reload('#jqGridSawonSel_cm_oam_<%=pcode%>','/cmsajax.do',params);	$("form[name=pagego]").find("#pstate").val("L");}//조회 : 그리드 조회function refreshOrgGrid_cm_oam_<%=pcode%>(isNotCheckVal){	//var _frm = document.listfrm;	//_frm.action='<%=RequestURL%>';	var searchresult = new Array();	if(isNotCheckVal==true){		if(getLength($("#org_stext_cm_oam_<%=pcode%>").val()) < 4){			alert("검색어는 한글2자 영문4자이상 입력해주세요.");			return;		} 				// 전체, 조직코드, 조직명		if(($("#org_sty_cm_oam_<%=pcode%>").val()=="" || $("#org_sty_cm_oam_<%=pcode%>").val()=="cd" || $("#org_sty_cm_oam_<%=pcode%>").val()=="nm")				&& $("#org_stext_cm_oam_<%=pcode%>").val()!=""){			searchresult = $.fn.cmtree.searchTree($("#org_sty_cm_oam_<%=pcode%>").val(), $("#org_stext_cm_oam_<%=pcode%>").val());			//alert(searchresult.join(","));						$("form[name=pagego]").append("<input type='hidden' name='seltreeorgcd' id='seltreeorgcd' value='"+searchresult.join(",")+"'/>");			$("form[name=pagego]").append("<input type='hidden' name='sty' id='sty' value='"+$("#org_sty_cm_oam_<%=pcode%>").val()+"'/>");			$("form[name=pagego]").append("<input type='hidden' name='stext' id='stext' value='"+$("#org_stext_cm_oam_<%=pcode%>").val()+"'/>");			//$("#seltreeorgcd").val(searchresult.join(","));		// 사원명		}else if($("#org_sty_cm_oam_<%=pcode%>").val()=="user_nm" && $("#org_stext_cm_oam_<%=pcode%>").val()!=""){			$("form[name=pagego]").append("<input type='hidden' name='sty' id='sty' value='"+$("#org_sty_cm_oam_<%=pcode%>").val()+"'/>");			$("form[name=pagego]").append("<input type='hidden' name='stext' id='stext' value='"+$("#org_stext_cm_oam_<%=pcode%>").val()+"'/>");				//alert($("form[name=pagego]").find("#stext").val());			}				$("form[name=pagego]").append("<input type='hidden' name='subinYn' id='subinYn' value='"+$("#subinYn_cm_oam_<%=pcode%>").val()+"'/>");	}		$("form[name=pagego]").find("#scode").val("000008");	$("form[name=pagego]").find("#pcode").val("000038");	//alert($("form[name=pagego]").find("#seltreeorgcd").val());	//alert($("form[name=pagego]").find("#subinYn").val());	//alert($("#subinYn_cm_oam_<%=pcode%>").val());			var params = getOrgGridParamDatas_cm_oam_<%=pcode%>();	com.grid.reload('#jqGridSawonSel_cm_oam_<%=pcode%>','<c:url value='/cmsajax.do'/>',params);	CmopenpageDisable();	//$("#seltreeorgcd").val("");		$("form[name=pagego]").find("#seltreeorgcd").remove();	$("form[name=pagego]").find("#sty").remove();	$("form[name=pagego]").find("#stext").remove();	$("form[name=pagego]").find("#subinYn").remove();}//그리드 조회시 요청할 파라미터 objectfunction getOrgGridParamDatas_cm_oam_<%=pcode%>(){	var _params = com.frm.getParamJSON($("form[name=pagego]"));	_params.pstate = 'PX2';	return _params;}function treeClickTitleSawon_cm_oam_<%=pcode%>(rtnArr){	//0: TREE_SEQ, 1: TREE_CD, 2: TREE_NM, 3:TREE_UPPO_CD, 4: TREE_LEVEL, 5: TREE_NMS, 6: TREE_CDS, 7: TREE_SUB_CNT	//$.fn.cmtree.selTreeParentAll('#cmtree_data_org_cm_oam_<%=pcode%>',rtnArr[6], rtnArr[4]);//조직트리 해당 조직으로 선택	$.fn.cmtree.selTreeParentAll(rtnArr[1], rtnArr[4]);//조직트리 해당 조직으로 선택		$("form[name=pagego]").find("#scode").val("000008");	$("form[name=pagego]").find("#pcode").val("000038");	$("form[name=pagego]").append("<input type='hidden' name='seltreeorgcd' id='seltreeorgcd' value='"+rtnArr[1]+"'/>");	$("form[name=pagego]").append("<input type='hidden' name='subinYn' id='subinYn' value='"+$("#subinYn_cm_oam_<%=pcode%>").val()+"'/>");		refreshOrgGrid_cm_oam_<%=pcode%>(false);		$("form[name=pagego]").find("#seltreeorgcd").remove();}function org_stext_keydown_cm_oam_<%=pcode%>(){		//alert(e.keyCode);		var eobj = event.srcElement ? event.srcElement : event.target;		if(event.keyCode == 13){			refreshOrgGrid_cm_oam_<%=pcode%>(true);		}}var fm_bs_off_nm_<%=pcode%> = function(cellvalue, options, rowObject){	var returnCell = "";	var org_nms_sp = rowObject.org_nms.split("::");	var org_cs_sp = rowObject.org_cs.split("::");	if(org_cs_sp.length < 3){		if(org_cs_sp.length == 1){			returnCell = "사업소외";		}else{			if(org_cs_sp[1]=="A000"){				returnCell = org_nms_sp[1];			}else{				returnCell = "사업소외";			}		}	}else{		if(org_cs_sp[1]=="A000"){			returnCell = org_nms_sp[2];		}else{			returnCell = "사업소외";		}			}	return returnCell;};var fm_bs_off_cd_<%=pcode%> = function(cellvalue, options, rowObject){	var returnCell = "";	var org_nms_sp = rowObject.org_nms.split("::");	var org_cs_sp = rowObject.org_cs.split("::");	if(org_cs_sp.length < 3){		if(org_cs_sp.length == 1){			returnCell = "0000";		}else{			if(org_cs_sp[1]=="A000"){				returnCell = org_cs_sp[1];			}else{				returnCell = "0000";			}		}	}else{		if(org_cs_sp[1]=="A000"){			returnCell = org_cs_sp[2];		}else{			returnCell = "0000";		}			}			return returnCell;};