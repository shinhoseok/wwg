<%--/*=================================================================================*//* 시스템            : 공통관리(CM)/* 프로그램 아이디   : /WEB-INF/jsp/ji/cm/oam/jicm_oam_020_s1/* 프로그램 이름     : jicm_oam_020_s1    /* 소스파일 이름     : jicm_oam_020_s1.jsp/* 설명              : 인력정보 조회화면/* 버전              : 1.0.0/* 최초 작성자       : 박창현/* 최초 작성일자     : 2015/03/26/* 최근 수정자       : 박창현/* 최근 수정일시     : 2015/03/26/* 최종 수정내용     : 최초작성/*=================================================================================*/--%><%@page pageEncoding="utf-8"%>	<script language="javascript" src="<%=con_root%>/js/com-tree.js"></script>	<script type="text/javascript">var searchYn = false;// TODO : $(function()$(function(){	// 조직트리	var cmtreeval = new Array();	//init tree	$.fn.cmtree({		 id			: '#cmtree_data' 		 ,treeAreaId : "#treeArea"		 ,treeMenuId : "#treeMenu"		 ,treeHeight : ($("#content").height()+35)+"px"		 ,treeWidth  : "250px"		 ,treemHeight : ($("#content").height()-5)+"px"		 ,treemWidth : "210px"	 		 ,checkBoxYn: false		 ,treeArr   : cmtreeval		 ,onClickTitlefn: "treeClickTitle01"		 ,treeRelComboId : "org_select_group"		 ,treeRelComboboxId : "org_option"		 ,treeImgPath : "<%=img_url%>"	});		//사용자 리스트		var cols =[{label:'번호'				,name:'row_seqno'			,index:'row_seqno'			,align:'center'		,width:'60'		,hidden:false	,sortable:false}				   ,{label:'사용자 명'			,   name:'user_nm'          ,index:'user_nm'			,align:'center'		,width:'100'	,hidden:false	,sortable:false,formatter : modifyemp }          				   ,{label:'사용자 ID'			,   name:'user_id'          ,index:'user_id'			,align:'center'		,width:'100'	,hidden:false	,sortable:false }				   ,{label:'최상위조직명'		,   name:'emp_top_org_nm'   ,index:'emp_top_org_nm'		,align:'center'		,width:'150'	,hidden:false	,sortable:false }		           ,{label:'부서명'			,   name:'org_nm'           ,index:'org_nm'             ,align:'center'		,width:'150'	,hidden:false	,sortable:false }		           ,{label:'직급'           ,   name:'grd_nm'           ,index:'grd_nm'             ,align:'center'  ,width:'100'  ,hidden:false  ,sortable:false }		           ,{label:'직위'           ,   name:'pos_nm'           ,index:'pos_nm'             ,align:'center'  ,width:'150'  ,hidden:false  ,sortable:false }		           /* ,{label:'연락전화번호'           ,   name:'cntac_phoneno'           ,index:'cntac_phoneno'             ,align:'center'  ,width:'80'  ,hidden:false  ,sortable:false } */		           //,{label:'입사일'           ,   name:'entcomp'           ,index:'entcomp'             ,align:'center'  ,width:'80'  ,hidden:false  ,sortable:false }		           //,{label:'퇴사일'           ,   name:'outcomp_ymd'           ,index:'outcomp_ymd'             ,align:'center'  ,width:'80'  ,hidden:false  ,sortable:false }		           <%		           // 관리권한이 있는 사용자만 그리드 항목을 보여준다.		           if(isMenuMng == true){		           %>		           ,{label:'재직여부'			,   name:'state_cd'	,index:'state_cd'		,align:'center'		,width:'100'	,hidden:false  	,sortable:false,formatter : fm_user_state_cd }		           ,{label:'사용시작일'			,   name:'use_st_ymd'		,index:'use_st_ymd'			,align:'center'		,width:'100'	,hidden:true  	,sortable:false }		           ,{label:'사용종료일'			,   name:'use_end_ymd'		,index:'use_end_ymd'		,align:'center'		,width:'100'	,hidden:true  	,sortable:false }		           ,{label:'가입승인'			,   name:'bigo1'			,index:'bigo1'				,align:'center'		,width:'80'		,hidden:true  	,sortable:false,formatter : joinuser }		           		           ,{label:'로그인초기화'		,   name:'bigo2'			,index:'bigo2'				,align:'center'		,width:'110'	,hidden:false  	,sortable:false,formatter : resetlogcnt }		           ,{label:'비밀번호초기화'		,   name:'bigo3'			,index:'bigo3'				,align:'center'		,width:'110'	,hidden:false  	,sortable:false,formatter : delpass }		           ,{label:'보유 권한'		,   name:'bigo4'			,index:'bigo4'				,align:'center'		,width:'110'	,hidden:false  	,sortable:false,formatter : permission }		           <%		           }		           %>		           ,{label:'가입여부'			,   name:'join_yn'			,index:'join_yn'			,align:'center'  	,width:'0'  	,hidden:true  	,sortable:false}		           		           ,{label:'key'			,   name:'user_seqno'		,index:'user_seqno'			,align:'center'  	,width:'0'  	,hidden:true  	,sortable:false}			    ];//init gridvar grid = com.grid.init({	 id			: '#jqGrid' 	,viewrecords: true	,height		: 364	,autowidth : true    <%    // 관리권한이 있는 사용자만 그리드 항목을 모두보여준다    if(isMenuMng == true){    %>		,shrinkToFit: false // 컬럼이 그리드 width에 맞춰 자동으로 맞춰질지 여부	<%    }else{    %>    ,shrinkToFit: true // 컬럼이 그리드 width에 맞춰 자동으로 맞춰질지 여부    <%    }	%>	,rowNum		: 15	,ajaxGridOptions: { contentType: "application/json;charset=utf-8" }	,gridComplete: function(){		mergeCellcomplet($(this));	}	,loadComplete: function(data){		// 로드 데이타 갯수 체크		if(searchYn){			isLoadData(data);			//return;		}				}		,onSelectRow: function(id) { // row를 선택했을때 액션.	}	,ondblClickRow: function(id) { // row를 선택했을때 액션.				var ret = $("#jqGrid").jqGrid("getRowData",id); // ret는 선택한 row 값을 쥐고있는 객체다.	    <%	    // 관리권한이 있는사용자만 상세조회, 수정화면으로 이동할수 있다.	    if(isMenuMng == true){	    %>				modify("" + ret.user_seqno + "");		<%	    }		%>	}	,custom : { //custom		 cols : cols //컬럼정보 - 필수!		,navButton : {			excel : {				exportName	: $('.con_title>h3').text().trim() //엑셀다운로드시 사용할 파일명			}		}	}});	var cols2 = [{label:'권한 그룹 리스트' , name:'auth_grp_nm', index:'auth_grp_nm',align:'center', width:'500',hidden:false	,sortable:false, formatter: fm_nm_str}				,{label:'그룹 코드' , name:'auth_grp_cd', index:'auth_grp_cd',align:'center', width:'0',hidden:true	,sortable:false}	];	var grid2 = com.grid.init({	 id			: '#jqGrid2' 	,viewrecords: true	,height		: 320	,rowNum		: 1000	,rowList	: 1000	,shrinkToFit: true // 컬럼이 그리드 width에 맞춰 자동으로 맞춰질지 여부	,autowidth : true	,multiselect: false	,viewrecords: true	//,rownumbers  : true 	//Row number 표시	,scroll : 1	,ajaxGridOptions: { contentType: "application/json;charset=utf-8" }	,gridComplete: function(){		mergeCellcomplet($(this));		//grid_win_resizeAuto();			}	,loadComplete: function(data){		// 로드 데이타 갯수 체크		var ids = $("#jqGrid2").jqGrid("getDataIDs");		if(ids.length > 0){			$("#jqGrid2").jqGrid("setSelection", ids[0]);			var ret = $("#jqGrid2").jqGrid("getRowData",ids[0]);			var grp_cd = ret.auth_grp_cd;			$("form[name=create_formfm2]").find("#per_cd").val(grp_cd);			refreshGrid3();		}				}		,onSelectRow: function(id) { // row를 선택했을때 액션.		var ret = $("#jqGrid2").jqGrid("getRowData",id);		var grp_cd = ret.auth_grp_cd;		$("form[name=create_formfm2]").find("#per_cd").val(grp_cd);		refreshGrid3();	}	,ondblClickRow: function(id) { // row를 선택했을때 액션.				//var ret = $("#jqGrid2").jqGrid("getRowData",id); // ret는 선택한 row 값을 쥐고있는 객체다.			}	,custom : { //custom		 cols : cols2 //컬럼정보 - 필수!		,navButton : {			 reorderCol : { //컬럼설정				 show : false			}			,excel : {				exportName	: $('.con_title>h3').text().trim() //엑셀다운로드시 사용할 파일명			}		}	}});		var cols3 = [{label:'권한 메뉴' , name:'menu_nm', index:'menu_nm',align:'center', width:'500',hidden:false	,sortable:false, formatter: fm_nm_str}				 	]; var grid2 = com.grid.init({	 id			: '#jqGrid3' 	,height		: 320	,rowNum		: 1000	,rowList	: 1000	,shrinkToFit: true // 컬럼이 그리드 width에 맞춰 자동으로 맞춰질지 여부	,autowidth : true	,multiselect: false	,viewrecords: true	//,rownumbers  : true 	//Row number 표시	,scroll : 1	,ajaxGridOptions: { contentType: "application/json;charset=utf-8" }	,gridComplete: function(){		mergeCellcomplet($(this));			}	,loadComplete: function(data){					}		,onSelectRow: function(id) { // row를 선택했을때 액션.		}	,ondblClickRow: function(id) { // row를 선택했을때 액션.				var ret = $("#jqGrid3").jqGrid("getRowData",id); // ret는 선택한 row 값을 쥐고있는 객체다.	}	,custom : { //custom		 cols : cols3 //컬럼정보 - 필수!		,navButton : {			 reorderCol : { //컬럼설정				 show : false			}			,excel : {				exportName	: $('.con_title>h3').text().trim() //엑셀다운로드시 사용할 파일명			}		}	}});		 	    /*  필드별 검색어 입력창을 숨기거나 보여지게한다. */    /* 	    jQuery("#jqGrid").jqGrid('navButtonAdd',"#jqGridPager",{caption:"Toggle",title:"Toggle Search Toolbar", buttonicon :'ui-icon-pin-s',	        onClickButton:function(){	        	grid[0].toggleToolbar();	        } 	    }); */	    /* 각 필드별 검색어 입력창에 입력된 내용를 지운다. *//* 	    jQuery("#jqGrid").jqGrid('navButtonAdd',"#jqGridPager",{caption:"Clear",title:"Clear Search",buttonicon :'ui-icon-refresh',	        onClickButton:function(){	        	grid[0].clearToolbar();	        } 	    }); */	    /*  필드별 검색어 입력창 */    		/* jQuery("#jqGrid").jqGrid('navGrid','#ptoolbar',{del:false,add:false,edit:false,search:false});		jQuery("#jqGrid").jqGrid('filterToolbar',{stringResult: true,searchOnEnter : false}); */				$("#btn_search").click( function() {		refreshTree();//트리조회		refreshGrid();			});		$('#useYn').click(function(){		        if ($("#useYn").is(":checked")) { 		        	$("#used").val("Y");		        } else { 		        	$("#used").val("");		        } 	}); 					//기준정보 등록 페이지 이동		$("#btn_save").click(function(e){			var selorg_option = "";			if($("select[name='org_option']").eq($("select[name='org_option']").length-1).val() == ""){				selorg_option = $("select[name='org_option']").eq($("select[name='org_option']").length-2).val();			}else{				selorg_option = $("select[name='org_option']").eq($("select[name='org_option']").length-1).val();			}			$("input[name='sorg_cd']").val(selorg_option);							  su_form=document.listfrm;				  su_form.method='post';				  su_form.pstate.value='CF';				  su_form.action='<%=RequestURL%>';				  su_form.submit();				  su_form.target = "";		});								$("#btn_excel").click(function(e){			//엑셀출력[화면,전체] - 파라미터(그리드명,엑셀구분[화면:"",전체:""],엑셀명)			//excelDownload("jqGrid","","<%=M_PATH_STR.substring(M_PATH_STR.lastIndexOf("::")+2)%> 화면리스트");			$("#pstate").val("XL1");			//return;			//엑셀출력[화면,전체] - 파라미터(그리드명,엑셀구분[화면:"",전체:"A"],엑셀명) 			excelDownload3("jqGrid","","<%=M_PATH_STR.substring(M_PATH_STR.lastIndexOf("::")+2)%> 화면리스트");			$("#pstate").val("L");					});					$("#btn_excelAll").click(function(e){						//엑셀출력[화면,전체] - 파라미터(그리드명,엑셀구분[화면:"",전체:"A"],엑셀명) - java 리스트쪽 구현해야함			//excelDownload("jqGrid","A","<%=M_PATH_STR.substring(M_PATH_STR.lastIndexOf("::")+2)%> 전체리스트");			$("#pstate").val("XL1");			//return;			//엑셀출력[화면,전체] - 파라미터(그리드명,엑셀구분[화면:"",전체:"A"],엑셀명) 			excelDownload3("jqGrid","A","<%=M_PATH_STR.substring(M_PATH_STR.lastIndexOf("::")+2)%> 전체리스트");			$("#pstate").val("L");					});				// 전체 사용자 비밀번호 초기화		$("#btn_all_pwInit").click(function(e){			//CmopenLoading();			//setTimeout(initAllPass(), 100);			initAllPass();		});					// 인사, 조직, 회원사 정보 갱신		$("#btn_all_linkage").click(function(e){			//CmopenLoading();			//setTimeout(initAllPass(), 100);			AllLinkage();		});						// 겸직관리		$("#btn_dup_org").click(function(e){			var selorg_option = "";			if($("select[name='org_option']").eq($("select[name='org_option']").length-1).val() == ""){				selorg_option = $("select[name='org_option']").eq($("select[name='org_option']").length-2).val();			}else{				selorg_option = $("select[name='org_option']").eq($("select[name='org_option']").length-1).val();			}			$("input[name='sorg_cd']").val(selorg_option);							  su_form=document.listfrm;				  su_form.method='post';				  su_form.pstate.value='L2';				  su_form.action='<%=RequestURL%>';				  su_form.submit();				  su_form.target = "";		});						//$("#pageDisable").ajaxStart(CmopenLoading());        //$("#pageDisable").ajaxStop(CmcloseLoading());						CmopenLoading();		refreshTree();//트리조회				// 조직 셀렉트 박스를 만든다		$.fn.cmtree.treeRelComboboxMake('','', 0);				<%		if(!HtmlTag.returnString((String)request.getAttribute("sorg_cd"),"").equals("")){		%>		treeClickTitle01($.fn.cmtree.rtnTreeArr('<%=HtmlTag.returnString((String)request.getAttribute("sorg_cd"),"")%>'));		<%		}		%>	 	    refreshGrid(false); //조회		setTimeout(grid_win_resizeAuto, 200);				CmcloseLoading();	    }).ajaxStart(function() {         // ajax 통신 시작 callback (로딩바 show)	 //console.log('start');	 CmopenLoading();	//$("#pageDisable").css({"width":"100%","height":($(document).height()+20)+"px","background": "url("+context_root+"/images/loading.gif) no-repeat center rgba(0, 0, 0, 0.5)"});}).ajaxStop(function() {        // ajax 통신 완료 callback (로딩바 hide)	//console.log('end');      	CmcloseLoading();});// TODO : joinuser//가입승인function joinuser(cellvalue, options, rowObject) {	var check=rowObject.join_yn;	var url ="";	if(check=="N"){	url = "<span class='btn_pack small'> <a href='#' onclick=join('" + rowObject.user_id + "'); >가입승인</a></span>";	}    return url;}//TODO : fm_nm_strfunction fm_nm_str(cellvalue, options, rowObject) {	var url ="";	if (cellvalue != undefined && cellvalue != null && cellvalue != '') {		cellvalue = cellvalue.replace(/&amp;amp;/gi,"&");		url = '' + cellvalue + '';			}  return url;}function fm_user_state_cd(cellvalue, options, rowObject) {	var url ="";	if(cellvalue=="C"){		url = "재직";	}else if(cellvalue=="H"){		url = "휴직";		}else if(cellvalue=="M"){		url = cellvalue;				}else{		url = "퇴직";	}    return url;}// TODO : resetlogcnt//로그인 실패 횟수 초기화function resetlogcnt(cellvalue, options, rowObject) {	var url ="";	url = "<span class='btn_pack small'> <a href='#' onclick=resetcnt('" + rowObject.user_id + "'); >실패횟수초기화 ("+rowObject.login_fail_cnt+")</a></span>";    return url;}// TODO : delpass//비밀번호 초기화 function delpass(cellvalue, options, rowObject) {	var url ="";	url = "<span class='btn_pack small'> <a href='#' onclick=passdel('" + rowObject.user_id + "'); >비밀번호초기화</a></span>";    return url;}function permission(cellvalue, options, rowObject){	var url ="";	url = "<span class='btn_pack small'> <a href='#' onclick=create_form_view2('" + rowObject.user_id + "'); >권한조회</a></span>";    return url;}//TODO : join//가입승인function join(userId) {	if(confirm("가입승인 하시겠습니까?")) {    $("#suser_id").val(userId);       $("#pstate").val("PU2");		var params = $("#listfrm").serialize();		CmopenLoading();		 $.ajax({             type: "post",             url: "<c:url value='/cmsajax.do'/>",             data: params,             async: false,             dataType:"json",             timeout: 3000,                       success: function(data){               if(data.result==true){                	alert('가입승인 처리 되었습니다.');                	refreshGrid();               }else{            	   	alert('가입승인 중 오류가 발생했습니다.');            	   	refreshGrid();               }               CmcloseLoading();             },		     error:function(request, status, error) {		    	 CmcloseLoading();		    	 refreshGrid();		    	 alert('가입승인 중 오류가 발생했습니다.');             }      });	}}//TODO : resetcntfunction resetcnt(userId) {	if(confirm("초기화 하시겠습니까?")) {    $("#suser_id").val(userId);       $("#pstate").val("PU1");		var params = $("#listfrm").serialize();		CmopenLoading();		 $.ajax({             type: "post",             url: "<c:url value='/cmsajax.do'/>",             data: params,             async: false,             dataType:"json",             timeout: 3000,             success: function(data){               if(data.result==true){                	alert('초기화되었습니다.');               }else{            	   alert('초기화중 오류가 발생했습니다.');               }               CmcloseLoading();             },		     error:function(request, status, error) {		    	 CmcloseLoading();		    	 alert('초기화중 오류가 발생했습니다.');             }      });	}}//TODO : passdel//비밀번호 초기화 function passdel(userId) {		if(confirm("초기화 하시겠습니까?\r\n초기화 하면\r\n '사용자아이디+^%$' \r\n로 초기화 됩니다")) {    $("#suser_id").val(userId);    $("#pstate").val("PU");		var params = $("#listfrm").serialize();				 $.ajax({             type: "post",             url: "<c:url value='/cmsajax.do'/>",             data: params,             async: false,             dataType:"json",             timeout: 3000,             success: function(data){               if(data.result==true){                	alert('초기화되었습니다.');               }else{            	   alert('초기화중 오류가 발생했습니다.');               }               CmcloseLoading();             },		     error:function(request, status, error) {		    			    	 alert('초기화중 오류가 발생했습니다.');		    	 CmcloseLoading();             },             beforeSend: function( xhr ) {            	 CmopenLoading();              }                   });	}else{		CmcloseLoading();		return;	}}//TODO : initAllPass//전체 비밀번호 초기화 function initAllPass() {	CmopenLoading(); 	//com.util.delay(100);	if(confirm("초기화 하시겠습니까?\r\n초기화 하면\r\n '사용자아이디+^%$' \r\n로 초기화 됩니다")) {		CmopenLoading();	}else{		CmcloseLoading();		return;	}		  $("#pstate").val("PU5");				var params = $("#listfrm").serialize();								 $.ajax({		           type: "post",		           url: "<c:url value='/cmsajax.do'/>",		           data: params,		           async: false,		           dataType:"json",		           timeout: 3000,		           global: true,		           success: function(data){		             if(data.result==true){		              	alert('초기화되었습니다.');		             }else{		          	   alert('초기화중 오류가 발생했습니다.');		             }		             CmcloseLoading();		           },				     error:function(request, status, error) {				    	 				    	 alert('초기화중 오류가 발생했습니다.');				    	 CmcloseLoading();		           },		             beforeSend: function( xhr ) {		            	 		           }		           		    });	}//TODO : AllLinkage//인사, 조직 , 정보 갱신function AllLinkage() {	CmopenLoading(); 	//com.util.delay(100);	if(confirm("인사,조직 정보를 갱신 하시겠습니까?")) {		CmopenLoading();	}else{		CmcloseLoading();		return;	}		  $("#pstate").val("PU6");				var params = $("#listfrm").serialize();								 $.ajax({		           type: "post",		           url: "<c:url value='/cmsajax.do'/>",		           data: params,		           async: false,		           dataType:"json",		           timeout: 3000,		           global: true,		           success: function(data){		             if(data.result==true){		              	alert('갱신되었습니다.');		              	refreshGrid();		             }else{		          	   alert('갱신중 오류가 발생했습니다.');		             }		             CmcloseLoading();		           },				     error:function(request, status, error) {				    	 				    	 alert('갱신중 오류가 발생했습니다.');				    	 CmcloseLoading();		           },		             beforeSend: function( xhr ) {		            	 		           }		           		    });	}//TODO : modifyemp//인력 수정화면 이동function modifyemp(cellvalue, options, rowObject) {	var url ="";	url = "" + textToHtml(cellvalue)  + "";    return url;}//TODO : modifyfunction modify(user_seqno) {	//alert(user_seqno);	$("input[name='suser_seq']").val(user_seqno);				  su_form=document.listfrm;	  su_form.method='post';	  su_form.pstate.value='UF';	  su_form.action='<%=RequestURL%>';	  su_form.submit();	  su_form.target = "";	}//TODO : refreshGrid//조회 : 그리드 조회// TODO : refreshGridfunction refreshGrid(isNotCheckVal){	var _frm = document.listfrm;	_frm.action='<%=RequestURL%>';			// 삭제포함이면	if($("#useYn").prop("checked")){		jQuery("#jqGrid").jqGrid('showCol',["del_yn"]);		}else{		jQuery("#jqGrid").jqGrid('hideCol',["del_yn"]);		}		searchYn = true;		var params = getGridParamDatas();	//alert("subinYn==>"+params.subinYn);	com.grid.reload('#jqGrid','<c:url value='/cmsajax.do'/>',params);}//TODO : getGridParamDatas//그리드 조회시 요청할 파라미터 objectfunction getGridParamDatas(){	var _params = com.frm.getParamJSON(document.listfrm);	_params.pstate = 'XL1';	return _params;}/*function optionGroup($this, lev){	    var param = "";    var combobox="";    var val=$this.val();    var id =$($this).attr('name');	var combolength = "";   	combobox = $("#"+$("#"+id).parent().attr('id'));		//select id로 크기를 가져와서 더큰놈은 다지우기   	    combolength = $("select[name^='"+id+"']").length;	//alert(combolength);	for(var i=combolength;lev<i;i--){	    $("#"+id+Number(i-1)).remove();	}	$("#pstate").val("X3");	if(val==""){		//alert(lev+":::::"+$("select[id^='"+id+(lev-1)+"']").val());		if($("select[id^='"+id+(lev-2)+"']").val()==undefined || $("select[id^='"+id+(lev-2)+"']").val()==""){			$("#org_cd").val("");		}else{			$("#org_cd").val($("select[id^='"+id+(lev-2)+"']").val());		}			}else{		$("#org_cd").val(val);	}		//alert(val);	var params = jQuery("#listfrm").serialize();	    params += "&sorg_cd="+val;	//alert(params);    if	($this.val() != ''){				 $.ajax({		             type: "post",		             url: "<c:url value='/cmsajax.do'/>",		             data:params,		             async: false,		             dataType:"json",		             success: function(data){		               if(data.optionlist!= ""){		            	   //alert(data.optionlist);		           		    combobox.append("<select name='"+id+"' id='"+(id+lev)+"' onchange='optionGroup($(this), "+Number(lev+1)+")'> <option value=''>선택없음</option> </select>");		           		    combobox = $("#"+id+lev);		                	combobox.append(data.optionlist);		               }		             }		      });				 			      }}*///조회 : 트리조회// TODO : refreshTreefunction refreshTree(){			//alert('refreshTree');	$("#pstate").val("XL2");	var params =  $("form[name=listfrm]").serialize();	//var params = jQuery('form').serialize();	//var params = com.frm.getParamJSON(document.listfrm);	//alert(params);	$.fn.cmtree.reload('#cmtree_data','<c:url value='/cmsajax.do'/>',params);	}//TODO : treeClickTitle01function treeClickTitle01(rtnArr){	//alert(rtnArr[1]+"---"+rtnArr[4]);	//0: TREE_SEQ, 1: TREE_CD, 2: TREE_NM, 3:TREE_UPPO_CD, 4: TREE_LEVEL, 5: TREE_NMS, 6: TREE_CDS, 7: TREE_SUB_CNT	//$.fn.cmtree.treeRelComboboxSet(rtnArr[1], rtnArr[4]);	//$.fn.cmtree.treeRelComboboxMake(rtnArr[1],'', rtnArr[4]);	$.fn.cmtree.selTreeParentAll(rtnArr[1], rtnArr[4]);//조직트리 해당 조직으로 선택	//$.fn.cmtree.treeRelComboboxMake(rtnArr[1],'', rtnArr[1]);			optionGroupToTree(rtnArr[6], rtnArr[4]);	//	//insertfInit();}//TODO : optionGroupToTreefunction optionGroupToTree(tree_cds, tree_level){	// 역으로 찾아가며 처리한다	var ogi = 0;	//alert(tree_cds+"---"+tree_level);	var tree_cds_sp = tree_cds.split("::");	for(ogi=0;ogi<tree_cds_sp.length;ogi++){		$("select[name='org_option']").eq(ogi).val(tree_cds_sp[ogi]);		optionGroup($("select[name='org_option']").eq(ogi), ogi+1, "N", "","N");			}		// 그리드 조회	refreshGrid(false); //조회	}//TODO : optionGroupfunction optionGroup($this, lev, treeyn, treecode, gridreloadyn){	//alert($this.attr("id"));	if(treeyn=="Y"){		$this.val(treecode);		$.fn.cmtree.treeRelComboboxMake(treecode,'', lev);//하위 셀렉트박스 생성		$.fn.cmtree.selTreeParentAll(treecode, lev);//트리 해당 코드로 선택				}else{		if(isEmpty($this.val())){			if(lev>1){				//alert($("select[name='smatrtpcd']").eq(lev-2).val()+"----"+(lev-2));				$.fn.cmtree.treeRelComboboxMake($("select[name='org_option']").eq(lev-2).val(),'', lev-1);//하위 셀렉트박스 생성								$.fn.cmtree.selTreeParentAll($("select[name='org_option']").eq(lev-2).val(), lev-1);//조직트리 해당 조직으로 선택								}else{				$.fn.cmtree.treeRelComboboxMake($this.val(),'', lev);//하위 셀렉트박스 생성								$.fn.cmtree.selTreeParentAll($this.val(), lev);//조직트리 해당 조직으로 선택							}				}else{			$.fn.cmtree.treeRelComboboxMake($this.val(),'', lev);//하위 셀렉트박스 생성						$.fn.cmtree.selTreeParentAll($this.val(), lev);//조직트리 해당 조직으로 선택					}				}		var opt_i = 0;	var opts_str = "";	// 현재 선택된 마지막 분류코드를 불러온다	var selorg_option = "";	var selorg_option_lev = "";	var selorg_option_lev4 = "";	if($("select[name='org_option']").eq($("select[name='org_option']").length-1).val() == ""){		selorg_option = $("select[name='org_option']").eq($("select[name='org_option']").length-2).val();	}else{		selorg_option = $("select[name='org_option']").eq($("select[name='org_option']").length-1).val();	}	$("input[name='sorg_cd']").val(selorg_option);		// 그리드 조회	if(gridreloadyn!="N"){		refreshGrid(false); //조회	}}</script><form name="listfrm" id="listfrm" method="post" onSubmit='return false;Go_search();' >        <input type="hidden" name="scode" id="scode" value="<%=scode%>" title="사이트코드" /><input type="hidden" name="pcode" id="pcode" value="<%=pcode%>" title="페이지코드"  /><input type="hidden" name="pstate" id="pstate" value="<%=pstate%>" title="페이지상태"  /><input type="hidden" name="curr_page" id="curr_page" value="<%=curr_page%>" title="현재페이지번호"  /><input type="hidden" name="show_rows" id="show_rows" value="<%=show_rows%>" title="현재페이지당데이터수"  /><input type="hidden" name="sidx" value="" title="선택된인덱스" /><input type="hidden" name="used" id="used" value="" /><input type="hidden" name="del" id="del" value="" /><input type="hidden" name="suser_id" id="suser_id" value="" /><input type="hidden" name="sorg_cd" id="sorg_cd" value="" /><input type="hidden" name="suser_seq" id="suser_seq" /><!-- 복합영역 --><div class="sectionBlue"> 	<!-- 트리 영역 -->	<div class="treeArea" id="treeArea">		<p class="tit round fL"><a href="#" onclick="cmtreechkCall()">조직도</a>		</p>		<div class="treeMenu round fL mR10" id="treeMenu">			<ul id="cmtree_data">			</ul>		</div>	</div>                                     	<div class="searchArea ">	  <table class="tbl_search">	    <colgroup>	    <col width="50" />	    <col width="150" />	    <col width="50" />	    <col width="200" />	    <col width="50" />	    <col width="*" />	    <col width="50" />	    <col width="*" />     	    </colgroup>	    <tr>		      <th scope="row">조직선택</th>				<td colspan="3" id="org_select_group" colspan="7">					<select name="org_option" id="org_option" onchange="optionGroup($(this), 1,'N','')">						<option value="">--선택--</option>					</select>				</td>						<th scope="row" style="display:none;">기준일자</th>				<td style="display:none;">					<input type="text" name="base_ymd" id="base_ymd" value="<%=curDate.substring(0,4)+"-"+curDate.substring(4,6)+"-"+curDate.substring(6,8)%>" size="12" onblur="is_valid_date(this);" onkeyup="maskCal();" onfocus="this.select();" title="기준일자 입력" class="fL"/>					<span class="btnIc_calendar" style="vertical-align:middle;"><a href="#" onclick="Calendar_D(document.getElementsByName('base_ymd')[0]);return false;"></a></span>				</td>					      		       <th scope="row" colspan="2">		         하위조직포함 : <select name="subinYn" id="subinYn" >		          <option value="Y">포함</option>		          <option value="N" selected>미포함</option>		        </select>	        		        </span>	        		      </th>	 	    </tr>	    	    <tr>		      <th scope="row">검색조건</th>		      <td>		        <select name="sty" id="sty" >		          <option value="">--선택--</option>		          <option value="user_nm">사용자명</option>		          <option value="user_id">사용자ID</option>		        </select>			  </td>		  		      <th scope="row">검색어</th>		      <td>		          <input type="text" name="stext" id="stext" />			  </td>	  		  			 	  <th scope="row" style="display:none;">퇴직자포함여부</th>		      <td style="display:none;">		        <select name="srt_yn" id="srt_yn" >		          <option value="Y">포함</option>		          <option value="N" selected>미포함</option>		        </select>       		      </td>		      			<%			// 관리권한이 없는 사용자만 보여주는 조건			//if(isMenuMng != true){			%>			      <td  colspan="2"  class="aR">		            						<%@include file="/WEB-INF/jsp/common/button_s.jsp"%>			  </td> 			<%			//}			%>		  	      </tr>	  </table>	  </div>	    <!-- end of search -->  	    	   <div class="section">		      <h3 class="fL mT10"><span>&#8226;</span>사용자 리스트</h3>		      <p class="fR mB5">		      	   <!-- <span class="btn_pack medium icon" id="btn_all_pwInit"><span class="privacy"></span><a href="#">전체비밀번호초기화</a></span> -->		           <span class="btn_pack medium icon" id="btn_excel" onclick="return false;"><span class="excel"></span><a href="#">화면출력</a></span>		           <span class="btn_pack medium icon" id="btn_excelAll" onclick="return false;"><span class="excel"></span><a href="#">전체출력</a></span>		           <span class="btn_pack medium icon" id="btn_all_linkage" onclick="return false;"><span class="privacy"></span><a href="#">인사정보갱신</a></span>		           <!-- <span class="btn_pack medium icon" id="btn_dup_org"><span class="privacy"></span><a href="#">겸직관리</a></span> -->		      </p>	    </div> 	    <div class="section" id="jqGridDiv">   	    	<table id='jqGrid' minuswh="250" fixwidth="N"></table>	    </div>	</form>		<div id=create_form_popup2 class="ly_pop" style="position:absolute;top:0%;left:0%;z-index:9991;width:1000px;display:none;">		<h1 id="per_title"><span>&#8226;</span> 보유 권한</h1><span class="close" id="btn_mail_loglist_close_icon" onclick="create_form_close2()"><a href="#" onclick="return false;" ></a></span>		<form name="create_formfm2" id="create_formfm2" method="post" onSubmit='return false;'>			<input type="hidden" name="scode" id="scode" value="<%=scode%>" title="사이트코드" />			<input type="hidden" name="pcode" id="pcode" value="<%=pcode%>" title="페이지코드"  />			<input type="hidden" name="pstate" id="pstate" value="<%=pstate%>" title="페이지상태"  />			<input type="hidden" name="curr_page" id="curr_page" value="<%=curr_page%>" title="현재페이지번호"  />			<input type="hidden" name="show_rows" id="show_rows" value="<%=show_rows%>" title="현재페이지당데이터수"  />				<input type="hidden" name="per_id" id="per_id" value="" title="권한조회 아이디"  />	        <input type="hidden" name="per_cd" id="per_cd" value=""/>	        <div class="searchArea mT0" style="margin:0px;padding:0px 0px !important;">			  <table class="tbl_search">			    <colgroup>			    <col width="50%" />			    <col width="50%" />			    </colgroup>			    			  </table>		  	  			</div> 						      		 	<div class="sectionBlue" id="jqGridDiv2">				<div style="width:49%;float:left;"><table id='jqGrid2' fixwidth="Y"></table></div>				<div style="width:49%;float:right;"><table id='jqGrid3' fixwidth="Y"></table></div>			</div>					<div class="section aC mT5 mB5" style="clear:both;padding-top:10px;">				<span class="btn_pack large" id="btn_create_form_close2"><a href="#" onclick="create_form_close2();return false;">닫기</a></span>			</div>                    			</form>	</div></div><script type="text/javascript">function create_form_close2(){	$("#create_form_popup2").hide();	create_form_init2();	CmclospageDisable();}//TODO : create_form_view2 //권한조회 팝업창function create_form_view2(per_id){	CmopenpageDisable();	  //$("#create_form_popup2").draggable({ opacity:"0.3",handle:"#mail_loglist_title" }); // 끄는 동안만 불투명도 주기  $("body").droppable({      accept: "#create_form_popup2",    // 드롭시킬 대상 요소      drop: function(event, ui) {      	$("#create_form_popup2").css({ opacity:"1.0" });      }  });  	$("form[name=create_formfm2]").find("#per_id").val(per_id);			//("#per_title").html("<span>&#8226;</span>"+selauth_grp_nm+" 변경 이력");		// 수정, 등록창의 위치를 잡는다	$("#create_form_popup2").css("left",( (($(document).width() - 1000) / 3) + $(document).scrollLeft()  )+"px");	$("#create_form_popup2").css("top", ( (($(document).height() - 640) / 2) + $(document).scrollTop() - (($(document).height() - 600) / 5)  )+"px");		//alert($("#org_text_div").scrollTop()+"==>"+sc_pos);	/*$("#gbox_jqGrid3").width(698);	$("#gview_jqGrid3").width(698);	$("#jqGrid3Pager").width(698);	$(".ui-jqgrid-hdiv").width(698);	$("#jqGrid3").width(698);*/	jQuery("#jqGrid2").jqGrid("setGridWidth",480);	$("#jqGrid2").width(480);	jQuery("#jqGrid3").jqGrid("setGridWidth",480);	$("#jqGrid3").width(480);		$("#create_form_popup2").show(500);	refreshGrid2();	}var getGridParamDatas2 = function(){	var _params = com.frm.getParamJSON2(document.create_formfm2);	_params.pstate = "XP2";	return _params;};  refreshGrid2 = function(){	$('#jqGrid2').jqGrid('clearGridData', true);		var _frm = document.create_formfm2;	_frm.action='<c:url value='/cmsmain.do'/>';	searchYn = true;	var params = getGridParamDatas2();	var formarr_params = "";		com.grid.reload('#jqGrid2','<c:url value='/cmsajax.do'/>'+formarr_params,params);}  var getGridParamDatas3 = function(){		var _params = com.frm.getParamJSON2(document.create_formfm2);		_params.pstate = "XP3";		return _params;	};    refreshGrid3 = function(){		$('#jqGrid3').jqGrid('clearGridData', true);		var _frm = document.create_formfm2;		_frm.action='<c:url value='/cmsmain.do'/>';		searchYn = true;		var params = getGridParamDatas3();		var formarr_params = "";				com.grid.reload('#jqGrid3','<c:url value='/cmsajax.do'/>'+formarr_params,params);	}  </script>	