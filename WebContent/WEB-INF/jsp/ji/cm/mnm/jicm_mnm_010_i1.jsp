<%--/*=================================================================================*//* 시스템            : 시스템 SYSTEM/* 프로그램 아이디   : /WEB-INF/jsp/ji/cm/mnm/jicm_mnm_010_i1/* 프로그램 이름     : jicm_mnm_010_i1   /* 소스파일 이름     : jicm_mnm_010_i1.jsp/* 설명              : SYSTEM 메뉴선택레이어/* 버전              : 1.0.0/* 최초 작성자       : 이금용/* 최초 작성일자     : 2014-02-05/* 최근 수정자       : 이금용/* 최근 수정일시     : 2014-02-05/* 최종 수정내용     : 최초작성/*=================================================================================*/--%><%@page pageEncoding="utf-8"%>// 조직트리var cmtreeval_cm_mnm_010_<%=pcode%> = new Array();var create_form_popup_width_cm_mnm_010_<%=pcode%> = 0;var create_form_popup_height_cm_mnm_010_<%=pcode%> = 0;var multi_yn_cm_mnm_010_<%=pcode%> = "";var check_yn_cm_mnm_010_<%=pcode%> = "";var returnId_cm_mnm_010_<%=pcode%> = "";var topmenu_cm_mnm_010_<%=pcode%> = "";//TODO : create_form_close_cm_mnm_010_<%=pcode%> //등록 ,수정창 닫기function create_form_close_cm_mnm_010_<%=pcode%>(){	$("#create_form_popup_cm_mnm_010_<%=pcode%>").hide();	create_form_init_cm_mnm_010_<%=pcode%>();	CmclospageDisable();}function btn_menu_search2_cm_mnm_010_<%=pcode%>(multi_yn, check_yn,returnId,topmenu) {	CmopenpageDisable();	var i = 0;	if(multi_yn==undefined || multi_yn==""){		multi_yn_cm_mnm_010_<%=pcode%> = "N";	}else{		multi_yn_cm_mnm_010_<%=pcode%> = multi_yn;	}		if(check_yn==undefined || check_yn==""){		check_yn_cm_mnm_010_<%=pcode%> = "Y";	}else{		check_yn_cm_mnm_010_<%=pcode%> = check_yn;	}		if(returnId==undefined || returnId==""){		returnId_cm_mnm_010_<%=pcode%> = "";	}else{		returnId_cm_mnm_010_<%=pcode%> = returnId;	}		if(topmenu==undefined || topmenu==""){		topmenu_cm_mnm_010_<%=pcode%> = "";	}else{		topmenu_cm_mnm_010_<%=pcode%> = topmenu;	}					var sc_pos = 0;	var pop_div_html = "";	var pop_contents_html = "";		pop_div_html = pop_div_html+'<div id="create_form_popup_cm_mnm_010_<%=pcode%>" class="ly_pop" style="position:absolute;top:0%;left:0%;z-index:9000;display:none;">';	pop_div_html = pop_div_html+'	<h1 id="ly_pop_title_cm_mnm_010_<%=pcode%>"><span>&#8226;</span>팝업</h1><span class="close" id="create_form_popup_close_cm_mnm_010_<%=pcode%>" onclick="create_form_close_cm_mnm_010_<%=pcode%>();return false;"><a href="#" onclick="return false;" ></a></span>';	pop_div_html = pop_div_html+'	<div id="create_form_popup_contents_cm_mnm_010_<%=pcode%>" style="padding:5px;"></div>';	pop_div_html = pop_div_html+'	<br />';	pop_div_html = pop_div_html+'	<div class="a_c" style="clear:both;margin-bottom:10px;padding-top:10px;" id="popup_btn_area_cm_mnm_010_<%=pcode%>">';	pop_div_html = pop_div_html+'		<span class="btn_1" id="create_form_popup_btn_confirm_cm_mnm_010_<%=pcode%>" onclick="btn_menu_confirm_cm_mnm_010_<%=pcode%>();return false;">확인</span>';	pop_div_html = pop_div_html+'		<span class="btn_2" id="create_form_popup_btn_close_cm_mnm_010_<%=pcode%>" onclick="create_form_close_cm_mnm_010_<%=pcode%>();return false;">닫 기</span>';	pop_div_html = pop_div_html+'	</div>';		pop_div_html = pop_div_html+'	<br />';	pop_div_html = pop_div_html+'</div>';			// 팝업 객체를 body 에 append한다		$("body").append(pop_div_html);		/*// 등록, 수정 폼 드래그앤 드롭 이동        $('#create_form_popup_cm_mnm_010_<%=pcode%>').draggable({ opacity:"0.3" }); // 끄는 동안만 불투명도 주기        $("body").droppable({            accept: "#create_form_popup_cm_mnm_010_<%=pcode%>",    // 드롭시킬 대상 요소            drop: function(event, ui) {            	$('#create_form_popup_cm_mnm_010_<%=pcode%>').css({ opacity:"1.0" });            }        });	*/			$("#create_form_popup_contents_cm_mnm_010_<%=pcode%>").html("");	// 팝업창 내용이 엄으면 만들어 준다	if($("#create_form_popup_contents_cm_mnm_010_<%=pcode%>").html()==""){		pop_contents_html = "";		pop_contents_html = pop_contents_html + '<div class="search_box" style="margin-bottom:10px;">';		pop_contents_html = pop_contents_html + '	<div class="seach_cell">';		pop_contents_html = pop_contents_html + '		<label for="">구분 :</label>';		pop_contents_html = pop_contents_html + '		<select id="org_sty_cm_mnm_010_<%=pcode%>" name="org_sty_cm_mnm_010_<%=pcode%>" style="width:100px;" title="팝업구분">';		pop_contents_html = pop_contents_html + '          <option value="">---- 전체 ----</option>';		pop_contents_html = pop_contents_html + '          <option value="nm">메뉴명</option>';		pop_contents_html = pop_contents_html + '          <option value="cd">메뉴코드</option>';		pop_contents_html = pop_contents_html + '        </select>';		pop_contents_html = pop_contents_html + '	</div>';					pop_contents_html = pop_contents_html + '	<div class="seach_cell">';		pop_contents_html = pop_contents_html + '		<label for="">검색어 :</label>';		pop_contents_html = pop_contents_html + '		<input type="text" id="org_stext_cm_mnm_010_<%=pcode%>"  name="org_stext_cm_mnm_010_<%=pcode%>" maxlength="100" title="" class="input_type01 w_normal seach_input" style="width:100px;"  value="" onkeydown="org_stext_keydown_cm_mnm_010_<%=pcode%>();" />';									 		pop_contents_html = pop_contents_html + '	</div>';								pop_contents_html = pop_contents_html + '	<div class="seach_cell" style="float:right;vertical-align:bottom;">';		pop_contents_html = pop_contents_html + '		<span class="search_btn" id="btn_org_search_cm_mnm_010_<%=pcode%>" onclick="searchTree_cm_mnm_010_<%=pcode%>();return false;">검색</span>';		pop_contents_html = pop_contents_html + '	</div>';		pop_contents_html = pop_contents_html + '</div>';		    	    pop_contents_html = pop_contents_html+'<span style="width:220px;float:left;margin-top:0px;"><div class="treeArea" id="treeArea"><div id="treeMenu"><ul id="cmtree_data_org_cm_mnm_010_<%=pcode%>"></ul></div></div></span>';		pop_contents_html = pop_contents_html+'</span>';				//$("#create_form_popup_cm_mnm_010_<%=pcode%>").width(600);		//$("#create_form_popup_cm_mnm_010_<%=pcode%>").height(600);		// 팝업창 타이틀		$("#ly_pop_title_cm_mnm_010_<%=pcode%>").html("<span>&#8226;</span>메뉴선택");		$("#create_form_popup_contents_cm_mnm_010_<%=pcode%>").html(pop_contents_html);			//$("#popup_btn_area").prepend("<span class='btn_1' id='create_form_popup_btn_confirm_cm_mnm_010_<%=pcode%>' onclick='btn_sawon_confirm_cm_mnm_010_<%=pcode%>();return false;'>확인</span>");		//alert('1111');						$.fn.cmtree({			 id			: '#cmtree_data_org_cm_mnm_010_<%=pcode%>' 			 ,treeAreaId : "#treeArea"			 ,treeMenuId : "#treeMenu"			 ,treeHeight : (592)+"px"			 ,treeWidth  : "470px"			 ,treemHeight : (592)+"px"			 ,treemWidth : "470px"				 ,checkBoxYn: true			 ,treeArr   : cmtreeval_cm_mnm_010_<%=pcode%>			 ,setAllYn : false			 ,onClickTitlefn: "treeClickTitleSawon_cm_mnm_010_<%=pcode%>"			 ,treeRelComboId : ""			 ,treeRelComboboxId : ""			 ,treeImgPath : "<%=img_url%>"		});		refreshOrgTree_cm_mnm_010_<%=pcode%>();//트리조회										//create_form_popup_width_cm_mnm_010_<%=pcode%> = 	$("#create_form_popup_cm_mnm_010_<%=pcode%>").width();		//create_form_popup_height_cm_mnm_010_<%=pcode%> =  $("#create_form_popup_cm_mnm_010_<%=pcode%>").height();				create_form_popup_width_cm_mnm_010_<%=pcode%> = 	(410+82);		create_form_popup_height_cm_mnm_010_<%=pcode%> =  (410+240);						}	$("#create_form_popup_cm_mnm_010_<%=pcode%>").width(create_form_popup_width_cm_mnm_010_<%=pcode%>);	$("#create_form_popup_cm_mnm_010_<%=pcode%>").height(create_form_popup_height_cm_mnm_010_<%=pcode%>);		// 수정, 등록창의 위치를 잡는다	$("#create_form_popup_cm_mnm_010_<%=pcode%>").css("left",( (($(document).width() - $("#create_form_popup_cm_mnm_010_<%=pcode%>").width()) / 2) + $(document).scrollLeft() )+"px");	$("#create_form_popup_cm_mnm_010_<%=pcode%>").css("top", ((($(document).height() - $("#create_form_popup_cm_mnm_010_<%=pcode%>").height()) / 5) + $(document).scrollTop() )+"px");			// 조직코드가 있을경우 해당조직을 선택한다	if(topmenu_cm_mnm_010_<%=pcode%>!=""){		treeClickTitleSawon_cm_mnm_010_<%=pcode%>($.fn.cmtree.rtnTreeArr('#cmtree_data_org_cm_mnm_010_<%=pcode%>',topmenu_cm_mnm_010_<%=pcode%>));	}				$("#create_form_popup_cm_mnm_010_<%=pcode%>").show(500);	    $("#create_form_popup_cm_mnm_010_<%=pcode%>").draggable({ opacity:"0.3",cancel:"#create_form_popup_contents_cm_mnm_010_<%=pcode%>" }); // 끄는 동안만 불투명도 주기        $("body").droppable({        accept: "#create_form_popup_cm_mnm_010_<%=pcode%>",    // 드롭시킬 대상 요소        drop: function(event, ui) {        	$("#create_form_popup_cm_mnm_010_<%=pcode%>").css({ opacity:"1.0" });        }    });			}function create_form_init_cm_mnm_010_<%=pcode%>(){	//$("#popup_btn_area").find("#create_form_popup_btn_confirm_cm_mnm_010_<%=pcode%>").remove();	$('#create_form_popup_cm_mnm_010_<%=pcode %>').remove();}//확정버튼function btn_menu_confirm_cm_mnm_010_<%=pcode%>(){		var rtnArr = $.fn.cmtree.chkTreeArr2('#cmtree_data_org_cm_mnm_010_<%=pcode%>');		if(rtnArr[0].length<1){			alert("선택된 메뉴가 없습니다.");			return;		}		//console.log("multi_yn_cm_mnm_010_<%=pcode%>===>"+multi_yn_cm_mnm_010_<%=pcode%>);		//console.log("rtnArr==>"+rtnArr[0].length+"===>"+rtnArr);		if(multi_yn_cm_mnm_010_<%=pcode%>!="Y"){// 한건 선택일 경우					if(rtnArr[0].length>1){				alert("메뉴를 한개만 선택해 주세요.");				return;			}		}		setMenuAdd_cm_mnm_010_<%=pcode%>(rtnArr);	    create_form_close_cm_mnm_010_<%=pcode%> ();	        }//조회 : 트리조회function refreshOrgTree_cm_mnm_010_<%=pcode%>(){	$("form[name=pagego]").find("#scode").val("000008");	$("form[name=pagego]").find("#pcode").val("000016");	$("form[name=pagego]").find("#pstate").val("MENUTREE");	$("form[name=pagego]").append("<input type='hidden' name='topmenu' id='topmenu' value='"+topmenu_cm_mnm_010_<%=pcode%>+"'/>");	var params =  $("form[name=pagego]").serialize();	$.fn.cmtree.reload('#cmtree_data_org_cm_mnm_010_<%=pcode%>','<c:url value='/cmsajax.do'/>',params);	$("form[name=pagego]").find("#pstate").val("L");	$("form[name=pagego]").find("#topmenu").remove();	}function searchTree_cm_mnm_010_<%=pcode%>(){		if(getLength($("#org_stext_cm_mnm_010_<%=pcode%>").val()) < 4){			alert("검색어는 한글2자 영문4자이상 입력해주세요.");			return;		} 		$.fn.cmtree.searchTree('#cmtree_data_org_cm_mnm_010_<%=pcode%>',$("#org_sty_cm_mnm_010_<%=pcode%>").val(), $("#org_stext_cm_mnm_010_<%=pcode%>").val());}function treeClickTitleSawon_cm_mnm_010_<%=pcode%>(rtnArr){	//0: TREE_SEQ, 1: TREE_CD, 2: TREE_NM, 3:TREE_UPPO_CD, 4: TREE_LEVEL, 5: TREE_NMS, 6: TREE_CDS, 7: TREE_SUB_CNT	//$.fn.cmtree.selTreeParentAll('#cmtree_data_org_cm_mnm_010_<%=pcode%>',rtnArr[6], rtnArr[4]);//조직트리 해당 조직으로 선택	$.fn.cmtree.selTreeParentAll('#cmtree_data_org_cm_mnm_010_<%=pcode%>',rtnArr[6], rtnArr[4]);//조직트리 해당 조직으로 선택		sel_org_cm_mnm_010_<%=pcode%> = $.fn.cmtree.rtnTreeArr('#cmtree_data_org_cm_mnm_010_<%=pcode%>',rtnArr[6]);}function org_stext_keydown_cm_mnm_010_<%=pcode%>(e){		//alert(e.keyCode);		var eobj = event.srcElement ? event.srcElement : event.target;		var evt_keycode = "";		//console.log("org_stext_keydown_cm_mnm_010_<%=pcode%>()==>event.keyCode::"+event.keyCode+"::eobj:");		if(window.event){			evt_keycode = window.event.keyCode;		}else if(e){			evt_keycode = e.which;		}				if(evt_keycode == 13){			//refreshOrgGrid_cm_mnm_010_<%=pcode%>(true);			searchTree_cm_mnm_010_<%=pcode%>();		}	}