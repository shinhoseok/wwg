<%@page pageEncoding="utf-8"%>	<%//jimp_msp_030_s1.jsp%><style>	.ui-th-column, .ui-jqgrid .ui-jqgrid-htable th.ui-th-column { white-space: normal; }	.ui-jqgrid-htable th{ text-align: center; }	.ui-th-ltr, .ui-jqgrid .ui-jqgrid-htable th.ui-th-ltr {border-left : 1px solid; border-left-color: #dcdcdc; }	.ui-th-rtl, .ui-jqgrid .ui-jqgrid-htable th.ui-th-rtl {border-right : 1px solid; border-right-color: #dcdcdc; }	</style><form name="listfrm" id="listfrm" method="post" onSubmit='return false;' >        <input type="hidden" name="scode" id="scode" value="<%=scode%>" title="사이트코드" /><input type="hidden" name="pcode" id="pcode" value="<%=pcode%>" title="페이지코드"  /><input type="hidden" name="pstate" id="pstate" value="<%=pstate%>" title="페이지상태"  /><input type="hidden" name="curr_page" id="curr_page" value="<%=curr_page%>" title="현재페이지번호"  /><input type="hidden" name="show_rows" id="show_rows" value="<%=show_rows%>" title="현재페이지당데이터수"  /><input type="hidden" name="ichag_seq" 	id="ichag_seq" /><fmt:parseDate var="sDate" pattern="yyyyMMdd" value="${R_MAP.param.sDate}" /><fmt:parseDate var="eDate" pattern="yyyyMMdd" value="${R_MAP.param.eDate}" /><div class="supply_box"><!--search-->	<div class="searchArea mT10">	  <table class="tbl_search">	    <colgroup>	    <col width="100">	    <col width="150">	    <col width="100">	    <col width="150">	    <col width="*">	    </colgroup>		    <tbody>		    	<tr>		    		<th scope="row">사업소</th>		        	<td>						<select name="sBsOfcOrgCd" id="sBsOfcOrgCd" title="사업소선택">							<option value="" <c:if test="'' == R_MAP.param.sBsOfcOrgCd}">selected="selected"</c:if>>전체</option>							<option value="NOTBsOfc" <c:if test="'NOTBsOfc' == R_MAP.param.sBsOfcOrgCd}">selected="selected"</c:if>>사업소외</option>							<c:forEach var="list" items="${R_MAP.rows}" varStatus="status">								<option value="<c:out value='${list.org_cd}'/>" <c:if test="${list.org_cd == R_MAP.param.sBsOfcOrgCd}">selected="selected"</c:if>><c:out value="${list.org_nm}"/></option>							</c:forEach>																	</select>		        	</td>		        	<th scope="row">설비분야</th>		        	<td>						<select name="sFecKindCd" id="sFecKindCd" title="설비분야 선택">							<option value="" <c:if test="'' == R_MAP.param.sFecKindCd}">selected="selected"</c:if>>전체</option>							<c:forEach var="list" items="${R_MAP.m00101List}" varStatus="status">								<option value="<c:out value='${list.stdinfoDtlCd}'/>" <c:if test="${list.stdinfoDtlCd == R_MAP.param.sFecKindCd}">selected="selected"</c:if>><c:out value="${list.stdinfoDtlNm}"/></option>							</c:forEach>																			</select>		        	</td>		        	<td style="text-align:right;">		        		<span class="btn_pack large vM" id="btn_search"><a href="#"  onclick="return false;">검색</a></span>		        		<span class="btn_pack largeO vM" id="btn_save"><a href="#" onclick="return false;">등록</a></span>		        	</td>				</tr>		  	</tbody>	  </table>	</div> 	<!--//search-->	<div class="section mB5">         <p class="fR"><!--            <span class="btn_pack medium icon" id="btn_excel" ><span class="excel"></span><a href="#" >화면출력</a></span> --><!--            <span class="btn_pack medium icon" id="btn_excelAll" ><span class="excel"></span><a href="#" >전체출력</a></span> -->		</p>	</div>	<!-- 그리드 영역 -->	<div class="section" id="jqGridDiv">		<table id='jqGrid' fixwidth="N"></table>	</div>		<!--button-->	<!-- 	<div class="button a_r mat_30">		<a href="#" class="btn_1 size_n" id="btn_reg">등록</a>	</div>	 -->	<!--//button-->	</div><!--//사외제공 절차--></form><script type="text/javascript">var searchYn = false;// TODO : $(function()		$(function(){			var cols =[{label:'번호'				,name:'row_seqno'				,index:'row_seqno'			,align:'center'		,width:'100'		,hidden:false		,sortable:false	}						,{label:'사업소'			,name:'bs_ofc_org_nm'			,index:'bs_ofc_org_nm'		,align:'center'		,width:'200'	,hidden:false		,sortable:false ,formatter : fm_bs_off_nm}						,{label:'설비분야'			,name:'fac_kind_cd_nm'			,index:'fac_kind_cd_nm'		,align:'center'		,width:'150'	,hidden:false		,sortable:false }						,{label:'부서명'			,name:'chag_user_org_nm'		,index:'chag_user_org_nm'	,align:'center'		,width:'200'	,hidden:false		,sortable:false }						,{label:'직급'			,name:'chag_user_grd_nm'		,index:'chag_user_grd_nm'	,align:'left'		,width:'120'	,hidden:false		,sortable:false 	}										   		,{label:'담당자명'			,name:'chag_user_nm'			,index:'chag_user_nm'		,align:'center'		,width:'120'	,hidden:false		,sortable:false 	}				   		,{label:'연락처'			,name:'chag_user_moblphon'		,index:'chag_user_moblphon'	,align:'left'		,width:'120'	,hidden:false		,sortable:false 	}				   		,{label:'E-mail'		,name:'chag_user_email'			,index:'chag_user_email'	,align:'left'		,width:'150'	,hidden:false		,sortable:false 	}				   						   		,{label:'사업소코드'		,name:'bs_ofc_org_cd'			,index:'bs_ofc_org_cd'		,align:'center'  	,width:'0'  	,hidden:true  		,sortable:false	}				   		,{label:'설비코드'			,name:'fac_kind_cd'				,index:'fac_kind_cd'		,align:'center'  	,width:'0'  	,hidden:true  		,sortable:false	}				   		,{label:'담당자사번'		,name:'chag_emp_no'				,index:'chag_emp_no'		,align:'center'  	,width:'0'  	,hidden:true  		,sortable:false	}				   		,{label:'등록자사번'		,name:'reg_id'					,index:'reg_id'				,align:'center'  	,width:'0'  	,hidden:true  		,sortable:false	}				   		,{label:'등록일자'			,name:'reg_dt'					,index:'reg_dt'				,align:'center'  	,width:'0'  	,hidden:true  		,sortable:false	}				   		,{label:'등록자명'			,name:'reg_user_nm'				,index:'reg_user_nm'		,align:'center'  	,width:'0'  	,hidden:true  		,sortable:false	}				   		,{label:'key'			,name:'chag_seq'				,index:'chag_seq'			,align:'center'  	,width:'0'  	,hidden:true  		,sortable:false	}			 			];					//init grid			var grid = com.grid.init({				 id			: '#jqGrid' 				,viewrecords: true				,height		: 480				,autowidth : true				,shrinkToFit: false				,rowNum		: 15				,ajaxGridOptions: { contentType: "application/json;charset=utf-8" }				,gridComplete: function(){					mergeCellcomplet($(this));				}				,custom : { //custom					 cols : cols //컬럼정보 - 필수!					,navButton : {						excel : {							exportName	: $('.con_title>h3').text().trim() //엑셀다운로드시 사용할 파일명						}					}				}				,loadComplete: function(data){					if(searchYn){						isLoadData(data);					}				}					,onSelectRow: function(id) {				}			});					    /*$("#jqGrid").jqGrid('setGroupHeaders',{				useColSpanStyle: true,    // 셀병합 여부(Group 대상 제외)		    	groupHeaders:[             // 명명한 컬럼으로 부터 n개까지 병합(Group 대상)		    													 {startColumnName: 'provd_charger_nm', numberOfColumns: 3, titleText: '가공'}								,{startColumnName: 'non_idntfc_sttus_cd_nm', numberOfColumns: 4, titleText: '비식별'}														]			});	*/							// 검색버튼		$("#btn_search").click( function() {			refreshGrid();		});					// 등록버튼		$("#btn_save").click( function() {			fnSaveGo();		});							// 검색어		$("#sKeyWord").keydown(function(e){			if(e.keyCode == 13){				refreshGrid();			}		});				$("#btn_excel").click(function(e){			$("#pstate").val("XL");			//엑셀출력[화면,전체] - 파라미터(그리드명,엑셀구분[화면:"",전체:""],엑셀명)			excelDownload3("jqGrid","","<%=M_PATH_STR.substring(M_PATH_STR.lastIndexOf("::")+2)%> 화면리스트", "<c:url value='/cmsmain.do'/>");		});					$("#btn_excelAll").click(function(e){			$("#pstate").val("XL");			//엑셀출력[화면,전체] - 파라미터(그리드명,엑셀구분[화면:"",전체:"A"],엑셀명) - java 리스트쪽 구현해야함			excelDownload3("jqGrid","A","<%=M_PATH_STR.substring(M_PATH_STR.lastIndexOf("::")+2)%> 전체리스트", "<c:url value='/cmsmain.do'/>");		});						refreshGrid(false);		CmcloseLoading();			}).ajaxStart(function() {		CmopenLoading();	}).ajaxStop(function() {		CmcloseLoading();	});		var refreshGrid = function(){				$('#jqGrid').jqGrid('clearGridData', true);		CmopenLoading();		var _frm = document.listfrm;		_frm.action='<%=RequestURL%>';		searchYn = true;		var params = getGridParamDatas();		var formarr_params = "";				com.grid.reload('#jqGrid','<c:url value='/cmsajax.do'/>'+formarr_params,params);		setTimeout(CmcloseLoading,1000);	};		var getGridParamDatas = function(){		var _params = com.frm.getParamJSON2(document.listfrm);		_params.pstate = "XL";		return _params;	};		var fnPageLink = function(cellvalue, options, rowObject){				if(rowObject.confm_cd == null){			rowObject.confm_cd = "";		}				if(rowObject.chf_dept_confmer == null){			rowObject.chf_dept_confmer = "";		}				var returnCell = "";				if (cellvalue) {			returnCell = '<a href="#" onclick="fnView(\'' + rowObject.dec_seqno + '\');return false;">'+ cellvalue.substring(0,4)+'-'+cellvalue.substring(4,6)+'-'+cellvalue.substring(6,8) +'</a>';		}				return returnCell;	};		/*var fndec_gbn = function(cellvalue, options, rowObject){		var returnCell = "";		if(rowObject.dec_gbn=="1"){			returnCell = "제공심의";		}else if(rowObject.dec_gbn=="5"){			returnCell = "반출심의";		}else{			returnCell = "제공심의";		}						return returnCell;	};*/		// 상세정보 화면	var fnView = function(dec_seqno){				su_form = document.listfrm;				$("#pstate").val("UF");				//alert(displayView+"------"+mng_sttus_cd+"------"+su_form.pstate.value);		su_form.method = 'post';		su_form.idec_seqno.value = dec_seqno;		su_form.action = '<%=RequestURL%>';		su_form.submit();		su_form.target = "";	};		var fnSaveGo = function(){		if(isEmpty($("#sFecKindCd").val())){			alert("담당자를 등록할 설비분야를 먼저 선택해주세요");			return;		}		su_form = document.listfrm;				$("#pstate").val("CF");				//alert(displayView+"------"+mng_sttus_cd+"------"+su_form.pstate.value);		su_form.method = 'post';		su_form.action = '<%=RequestURL%>';		su_form.submit();		su_form.target = "";	};			var fm_bs_off_nm = function(cellvalue, options, rowObject){		var returnCell = "";		var org_nms_sp = rowObject.org_nms.split("::");		var org_cs_sp = rowObject.org_cs.split("::");		if(org_cs_sp.length < 3){			if(org_cs_sp.length == 1){				returnCell = "사업소외";			}else{				if(org_cs_sp[1]=="A000"){					returnCell = org_nms_sp[1];				}else{					returnCell = "사업소외";				}			}		}else{			if(org_cs_sp[1]=="A000"){				returnCell = org_nms_sp[2];			}else{				returnCell = "사업소외";			}				}		return returnCell;	};		</script>