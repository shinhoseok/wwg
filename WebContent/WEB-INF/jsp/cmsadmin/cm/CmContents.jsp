<%--/*=================================================================================*//* 시스템            : JRCMS 시스템 SYSTEM/* 프로그램 아이디   : /WEB-INF/jsp/cmsadmin/cm/CmContents/* 프로그램 이름     : CmContents    /* 소스파일 이름     : CmContents.jsp/* 설명              : SYSTEM 컨텐츠관리 메인페이지/* 버전              : 1.0.0/* 최초 작성자       : 이금용/* 최초 작성일자     : 2014-02-19/* 최근 수정자       : 이금용/* 최근 수정일시     : 2014-02-19/* 최종 수정내용     : 최초작성/*=================================================================================*/--%><%@page pageEncoding="utf-8"%><%String sidx = HtmlTag.returnString((String)request.getAttribute("sidx"),"");List rtn_tmp_List = null;Map editor_map = new HashMap();
rtn_tmp_List = (List)rtn_Map.get("ListACT"); // 조회된 리스트String M_CONTENTS = "";String C_CSS = "";String C_JSCRIPT = "";String sel_color = "background-color:#ffffff;color:#000000;";%><script type="text/javascript" src="<%=con_root%>/smarteditor/js/HuskyEZCreator.js"></script><!--내용시작  --><form name="listfrm" method="post" onSubmit='return false;Go_search();'><input type="hidden" name="scode" value="<%=scode%>" title="사이트코드" /><input type="hidden" name="pcode" value="<%=pcode%>" title="페이지코드"  /><input type="hidden" name="pstate" value="<%=pstate%>" title="페이지상태"  /><input type="hidden" name="sidx" value="<%=sidx %>" title="선택된인덱스" />  <div class="sectionBlue"><table class="tbl_type3" id="cont_tb">	<colgroup>	      <col width="250" />	      <col width="*" />	</colgroup>	<tr>	<td style="vertical-align:top"><!-- 컨텐츠 이력 -->		<table cellspacing="0" cellpadding="0" class="defaultTable02" >			<colgroup>			<col width="100%" />			</colgroup>			<tr>			<th>등록된이력:<%=rtn_tmp_List.size()%>건			</th>			</tr>	<%		// 컨텐츠배열에 담긴값을 출력한다		if (rtn_tmp_List.size() < 1){	%>			<tr>			<td align="center"> 등록된 이력이 없습니다. </td>			</tr>	<%			}else{			for(i=0;i<rtn_tmp_List.size();i++){				rtn_row_Map = (Map)rtn_tmp_List.get(i);				sel_color = "background-color:#ffffff;color:#000000;";				// 초기 에디터에 셋팅될 값을 셋팅한다				if(sidx.equals("") && i==0){					editor_map = rtn_row_Map;					M_CONTENTS = HtmlTag.returnString((String)editor_map.get("M_CONTENTS"),"");					C_CSS = HtmlTag.returnString((String)editor_map.get("C_CSS"),"");					C_JSCRIPT = HtmlTag.returnString((String)editor_map.get("C_JSCRIPT"),"");					sel_color = "background-color:#30568F;color:#ffffff;";				}else{					if(sidx.equals(String.valueOf(rtn_row_Map.get("IDX")))){						editor_map = rtn_row_Map;						M_CONTENTS = HtmlTag.returnString((String)editor_map.get("M_CONTENTS"),"");						C_CSS = HtmlTag.returnString((String)editor_map.get("C_CSS"),"");						C_JSCRIPT = HtmlTag.returnString((String)editor_map.get("C_JSCRIPT"),"");												sel_color = "background-color:#30568F;color:#ffffff;";					}				}	%>						<tr height="25"  align="center"> 			<td align="left" style="<%=sel_color %>" onclick="Go_view(<%=rtn_row_Map.get("IDX")%>);"><%=(i+1)%>.<%=rtn_row_Map.get("REG_DT")%></td>			</tr>	<%			}		}		if(M_CONTENTS==null){			M_CONTENTS="";		}		M_CONTENTS = M_CONTENTS.replaceAll("&amp;amp;", "&").replaceAll("&lt;", "<").replaceAll("&gt;", ">");		C_JSCRIPT = C_JSCRIPT.replaceAll("&amp;", "&").replaceAll("&lt;", "").replaceAll("&gt;", "");			%>		</table>	</td>	<td style="vertical-align:top">		<table cellspacing="0" cellpadding="0" class="defaultTable02" >			<colgroup>			<col width="100%" />			</colgroup>			<tr>			<td>       			<p class="fR mL10">	       				<span class="btn_pack large vM" id="reg_btn"><a onclick="Go_wrin(); return false;" href="#" style="cursor:pointer" >저장</a></span>       				<span class="btn_pack large vM" id="del_btn" style="display:none;"><a onclick="Go_delin(); return false;" href="#" style="cursor:pointer" >삭제</a></span>       				<span class="btn_pack large vM" id="preview_btn" style="display:none;"><a onclick="Go_previw(); return false;" href="#" style="cursor:pointer" >미리보기</a></span>       				<span class="btn_pack large vM" id="reg_btn"><a href="<c:out value="${basePath}"/>/cmsmain.do?scode=sysadm&pcode=000556">목록</a></span>		      	</p>						</td>			</tr>			<tr>			<td>       			컨텐츠 CSS:<input type="text" id="C_CSS" name="C_CSS" value="<%=C_CSS%>" />						</td>			</tr>			<tr>			<td>       			컨텐츠 JAVASCRIPT:       			<textarea id="C_JSCRIPT" name="C_JSCRIPT" value="" style="width:100%;min-height:100px;"><%=C_JSCRIPT%></textarea>			</td>			</tr>														<tr><%				// 에디터 환경설정				String editor_table_size = "100%";				String editor_form_content="smarteditor";				String editor_cdiv="cdiv";					String editor_form_name = "listfrm";				String editor_dir_path = "/editer";								%>			<td><textarea name="<%=editor_form_content %>" id="smarteditor" style="width:100%;min-height:450px;"><%=M_CONTENTS%></textarea>
			</td>			</tr>		</table>	</td>	</tr></table></form>	

<script type='text/javascript'>
//<![CDATA[//글등록처리페이지이동function Go_wrin(){	var su_form=document.listfrm;	// textarea에 값 삽입	oEditors.getById["<%=editor_form_content %>"].exec("UPDATE_CONTENTS_FIELD", []);			/*var obj = document.getElementById("<%=editor_cdiv%>");		var objDoc = obj.contentWindow || obj.contentDocument;		objDoc.gogo();*/
		if(isEmpty(su_form.<%=editor_form_content%>.value)){		   alert('컨텐츠내용을 입력해주세요');		   return;		}
			  su_form.target = "successIframe";			  su_form.pstate.value='C';			  su_form.action='<%=RequestURL%>';			  su_form.submit();			  su_form.target = "";
}

//글수정처리페이지이동function Go_view(pidx){  su_form=document.listfrm;  su_form.sidx.value=pidx;  su_form.pstate.value='L';  su_form.action='<%=RequestURL%>';  su_form.submit();  su_form.target = "";}

// 삭제처리
function Go_delin(){	su_form=document.listfrm;	if(isEmpty(su_form.sidx.value)){		alert("삭제할 데이터가 없습니다.");		return;	}
	if(confirm("삭제하시겠습니까?")){		  su_form.target = "successIframe";	  su_form.pstate.value='D';	  su_form.action='<%=RequestURL%>';	  su_form.submit();	  su_form.target = "";	}else{		return;	}}

// 미리보기function Go_previw(){	var gpcode = "<%=MENUCFG.get("menuCd")%>";	var gpcodes = "<%=MENUCFG.get("mCodes")%>";	var gpcoses_sp = gpcodes.split("::");	var url = "<%=RequestURL%>?scode="+gpcoses_sp[1]+"&amp;pcode="+gpcode+"&amp;sidx="+$("form[name=listfrm]").find("input[name=sidx]").val();	var nm = "<%=MENUCFG.get("menuCd")%>_preview";	var w = $(window).width()*0.84;	var h = 600*0.92;	popWinScroll(url, nm, w, h);}

function set_idx(){	document.getElementsByName("sidx")[0].value="<%=HtmlTag.returnString((String)(editor_map.get("IDX")),"")%>";	if(document.getElementsByName("sidx")[0].value == ""){		$("#del_btn").hide();		$("#preview_btn").hide();	}else{		$("#del_btn").show();		$("#preview_btn").show();	}}

$(document).ready(function() {	// 화면이 로드될경우 초기셋팅값을 보여준다	set_idx();
});
var oEditors = [];nhn.husky.EZCreator.createInIFrame({    oAppRef: oEditors,    elPlaceHolder: "<%=editor_form_content %>",    sSkinURI: "<%=con_root%>/smarteditor/SmartEditor2Skin.html",    fCreator: "createSEditor2",    htParams: {fOnBeforeUnload:function(){}}	});
//]]>
</script>
<!--내용끝-->